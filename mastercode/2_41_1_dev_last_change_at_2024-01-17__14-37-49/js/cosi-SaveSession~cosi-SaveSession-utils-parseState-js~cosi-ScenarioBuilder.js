(window.webpackJsonp=window.webpackJsonp||[]).push([[8,342,343,344,350,353,354,356,395,396,399,413,422,431],{3650:function(j,N,d){var S=Object.create,p=Object.defineProperty,D=Object.getOwnPropertyDescriptor,x=Object.getOwnPropertyNames,L=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,F=(l,f,i,u)=>{if(f&&typeof f=="object"||typeof f=="function")for(let o of x(f))!T.call(l,o)&&o!==i&&p(l,o,{get:()=>f[o],enumerable:!(u=D(f,o))||u.enumerable});return l},P=(l,f,i)=>(i=l!=null?S(L(l)):{},F(f||!l||!l.__esModule?p(i,"default",{value:l,enumerable:!0}):i,l)),_=P(d(106));function b(l){var f;if(typeof l!="object"||l===null||typeof l.getSource!="function"||typeof((f=l.getSource())==null?void 0:f.getFeatures)!="function")return console.error("utils/layer/getLayerSource: layer must be a layer with a vector source",l),null;const i=l.getSource();return i.constructor===_.default?i.getSource():i}j.exports={getLayerSource:b}},3651:function(j,N,d){var S=Object.create,p=Object.defineProperty,D=Object.getOwnPropertyDescriptor,x=Object.getOwnPropertyNames,L=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,F=(r,n)=>{for(var v in n)p(r,v,{get:n[v],enumerable:!0})},P=(r,n,v,O)=>{if(n&&typeof n=="object"||typeof n=="function")for(let w of x(n))!T.call(r,w)&&w!==v&&p(r,w,{get:()=>n[w],enumerable:!(O=D(n,w))||O.enumerable});return r},_=(r,n,v)=>(v=r!=null?S(L(r)):{},P(n||!r||!r.__esModule?p(v,"default",{value:r,enumerable:!0}):v,r)),b=r=>P(p({},"__esModule",{value:!0}),r),l={};F(l,{default:()=>t,getAllContainingDistricts:()=>h,getContainingDistrictForExtent:()=>c,getContainingDistrictForFeature:()=>a,intersect:()=>e,union:()=>s}),j.exports=b(l);var f=_(d(4171)),i=_(d(4169)),u=d(58),o=d(5);function h(r,n,v=!1){var O;const w=[];for(const m of r)for(const y of m.districts){const g=(O=y.adminFeature)==null?void 0:O.getGeometry(),M=n.getGeometry().getExtent();if((!g||g.intersectsExtent(M))&&(w.push({districtLevel:m.label,district:y}),!v))break}return v?w:w[0]}function a(r,n,v=!0,O=!1){const w=[];for(const m of r.districts){const y=m.adminFeature.getGeometry(),g=n.getGeometry().getExtent(),M=(0,o.getCenter)(g);if(O)y.intersectsExtent(g)&&w.push(v?m:m.getName());else if(y.intersectsCoordinate(M)){w.push(v?m:m.getName());break}}return O?w:w[0]}function c(r,n,v=!0,O=!1){const w=[];for(const m of r.districts)if(m.adminFeature.getGeometry().intersectsExtent(n)&&(w.push(v?m:m.getName()),!O))break;return O?w:w[0]}function s(r,n=!1,v=!1,O="EPSG:25832",w="EPSG:4326"){const m=new u.GeoJSON({dataProjection:w,featureProjection:O}),y=m.writeFeaturesObject(r);let g=y.features[0];for(let M=1;M<y.features.length;M++)g=(0,f.default)(g,y.features[M]);return n&&(g.properties={}),v&&(g=m.readFeature(g)),g}function e(r,n=!1,v=!1,O="EPSG:25832",w="EPSG:4326"){const m=new u.GeoJSON({dataProjection:w,featureProjection:O}),y=m.writeFeaturesObject(r);let g=y.features[0];for(let M=1;M<y.features.length;M++)g=(0,i.default)(g,y.features[M]);return g&&(n&&(g.properties={}),v&&(g=m.readFeature(g))),g}var t={intersect:e,union:s,getContainingDistrictForFeature:a}},3652:function(j,N){var d=Object.defineProperty,S=Object.getOwnPropertyDescriptor,p=Object.getOwnPropertyNames,D=Object.prototype.hasOwnProperty,x=(_,b)=>{for(var l in b)d(_,l,{get:b[l],enumerable:!0})},L=(_,b,l,f)=>{if(b&&typeof b=="object"||typeof b=="function")for(let i of p(b))!D.call(_,i)&&i!==l&&d(_,i,{get:()=>b[i],enumerable:!(f=S(b,i))||f.enumerable});return _},T=_=>L(d({},"__esModule",{value:!0}),_),F={};x(F,{default:()=>P}),j.exports=T(F);function P(_,b){const l=document.createElement("a"),f=URL.createObjectURL(_);l.setAttribute("href",f),l.setAttribute("download",b),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l)}},3653:function(j,N,d){var S=Object.create,p=Object.defineProperty,D=Object.getOwnPropertyDescriptor,x=Object.getOwnPropertyNames,L=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,F=(c,s)=>{for(var e in s)p(c,e,{get:s[e],enumerable:!0})},P=(c,s,e,t)=>{if(s&&typeof s=="object"||typeof s=="function")for(let r of x(s))!T.call(c,r)&&r!==e&&p(c,r,{get:()=>s[r],enumerable:!(t=D(s,r))||t.enumerable});return c},_=(c,s,e)=>(e=c!=null?S(L(c)):{},P(s||!c||!c.__esModule?p(e,"default",{value:c,enumerable:!0}):e,c)),b=c=>P(p({},"__esModule",{value:!0}),c),l={};F(l,{default:()=>a,download:()=>i,downloadCsvToFile:()=>h,downloadJsonToFile:()=>u,downloadTextToFile:()=>o}),j.exports=b(l);var f=_(d(3652));function i(c,s){const e=document.createElement("a");e.setAttribute("href",c),e.setAttribute("download",s),e.style.visibility="hidden",document.body.appendChild(e),e.click(),document.body.removeChild(e)}function u(c,s){const e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(c));i(e,s)}function o(c,s){const e="data:text/plain;charset=utf-8,"+encodeURI(c);i(e,s)}function h(c,s){const e="data:text/csv;charset=utf-8,"+encodeURI(c);i(e,s)}var a={download:i,downloadCsvToFile:h,downloadJsonToFile:u,downloadTextToFile:o,downloadBlobToFile:f.default}},3654:function(j,N,d){var S=Object.create,p=Object.defineProperty,D=Object.getOwnPropertyDescriptor,x=Object.getOwnPropertyNames,L=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,F=(u,o,h,a)=>{if(o&&typeof o=="object"||typeof o=="function")for(let c of x(o))!T.call(u,c)&&c!==h&&p(u,c,{get:()=>o[c],enumerable:!(a=D(o,c))||a.enumerable});return u},P=(u,o,h)=>(h=u!=null?S(L(u)):{},F(o||!u||!u.__esModule?p(h,"default",{value:u,enumerable:!0}):h,u)),_=P(d(21)),b=d(58),l=P(d(18));function f(u,o=!1,h="EPSG:25832",a="EPSG:4326"){if(!(0,l.default)(u)||!(u instanceof _.default))return console.error("utils/features/convertToGeoJson: The first parameter must be an ol feature object, but got "+typeof u),!1;if(typeof o!="boolean")return console.error("utils/features/convertToGeoJson: The second parameter must be a boolean, but got "+typeof o),!1;if(typeof h!="string"||typeof a!="string")return console.error("utils/features/convertToGeoJson: The third and the fourth parameter must both be a string, but got "+typeof h+" and "+typeof a),!1;const c=new b.GeoJSON({dataProjection:a,featureProjection:h});return o?c.writeFeature(u):c.writeFeatureObject(u)}function i(u,o=!1,h="EPSG:25832",a="EPSG:4326"){if(!Array.isArray(u))return console.error("utils/features/convertToGeoJson: The first parameter must be an array, but got "+typeof u),!1;if(typeof o!="boolean")return console.error("utils/features/convertToGeoJson: The second parameter must be a boolean, but got "+typeof o),!1;if(typeof h!="string"||typeof a!="string")return console.error("utils/features/convertToGeoJson: The third and the fourth parameter must both be a string, but got "+typeof h+" and "+typeof a),!1;const c=new b.GeoJSON({dataProjection:a,featureProjection:h});return o?c.writeFeatures(u):c.writeFeaturesObject(u)}j.exports={featureToGeoJson:f,featuresToGeoJsonCollection:i}},3656:function(j,N,d){var S=Object.defineProperty,p=Object.getOwnPropertyDescriptor,D=Object.getOwnPropertyNames,x=Object.prototype.hasOwnProperty,L=(l,f)=>{for(var i in f)S(l,i,{get:f[i],enumerable:!0})},T=(l,f,i,u)=>{if(f&&typeof f=="object"||typeof f=="function")for(let o of D(f))!x.call(l,o)&&o!==i&&S(l,o,{get:()=>f[o],enumerable:!(u=p(f,o))||u.enumerable});return l},F=l=>T(S({},"__esModule",{value:!0}),l),P={};L(P,{default:()=>_,getLastAvailableYear:()=>b}),j.exports=F(P);function _(l,f="jahr_"){const i=[];return l.forEach(u=>{const o=u.getProperties?u.getProperties():u;Object.keys(o).forEach(h=>{h.includes(f)&&i.push(h.replace(f,""))})}),[...new Set(i)].sort().reverse()}function b(l,f="jahr_"){const i=l.map(u=>Object.keys(u.getProperties()).map(o=>parseInt(o.replace(f,""),10)).filter(o=>!isNaN(o)).sort((o,h)=>h-o));for(let u=0;u<i.length;u++)for(let o=0;o<i[u].length;o++){const h=i[u][o];if(i.every(a=>a.includes(h)))return h}return _(l,f)[0]}},3662:function(j,N){var d=Object.defineProperty,S=Object.getOwnPropertyDescriptor,p=Object.getOwnPropertyNames,D=Object.prototype.hasOwnProperty,x=(_,b)=>{for(var l in b)d(_,l,{get:b[l],enumerable:!0})},L=(_,b,l,f)=>{if(b&&typeof b=="object"||typeof b=="function")for(let i of p(b))!D.call(_,i)&&i!==l&&d(_,i,{get:()=>b[i],enumerable:!(f=S(b,i))||f.enumerable});return _},T=_=>L(d({},"__esModule",{value:!0}),_),F={};x(F,{default:()=>P}),j.exports=T(F);function P(_,b){const l=_.getGeometry();if(Array.isArray(b)&&b.length===2&&typeof b[0]=="number"&&typeof b[1]=="number"){const f=l.getExtent().getCenter(),i=b[0]-f[0],u=b[1]-f[1];l.translate(i,u)}else _.setGeometry(b.clone())}},3720:function(j,N,d){var S=Object.create,p=Object.defineProperty,D=Object.getOwnPropertyDescriptor,x=Object.getOwnPropertyNames,L=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,F=(e,t)=>{for(var r in t)p(e,r,{get:t[r],enumerable:!0})},P=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let v of x(t))!T.call(e,v)&&v!==r&&p(e,v,{get:()=>t[v],enumerable:!(n=D(t,v))||n.enumerable});return e},_=(e,t,r)=>(r=e!=null?S(L(e)):{},P(t||!e||!e.__esModule?p(r,"default",{value:e,enumerable:!0}):r,e)),b=e=>P(p({},"__esModule",{value:!0}),e),l={};F(l,{default:()=>s}),j.exports=b(l);var f=d(3650),i=d(3721),u=_(d(3731)),o=_(d(3732)),h=_(d(3662)),a=d(152),c=_(d(3733));class s{constructor(t,r,n,v){this.feature=t,this.layer=r,this.guideLayer=n,this.scenarioData=v||{},this.scenario=null,this.eventKeys={},(0,u.default)(this.feature)}renderFeature(t){(0,f.getLayerSource)(this.layer).addFeature(this.feature),this.eventKeys[this.feature.getId()]=(0,f.getLayerSource)(this.layer).on("change",()=>{(0,c.default)(this)}),(t||this.guideLayer)&&(this.guideLayer=t||this.guideLayer,(0,i.addSimulationTag)(this.feature,this.guideLayer,this.layer))}hideFeature(){const t=(0,f.getLayerSource)(this.layer);(0,a.unByKey)(this.eventKeys.modifier),(0,a.unByKey)(this.eventKeys[this.feature.getId()]),t.getFeatureById(this.feature.getId())&&t.removeFeature(this.feature),this.guideLayer&&(0,i.removeSimulationTag)(this.feature,this.guideLayer)}restoreScenarioProperties(){for(const t in this.scenarioData)this.feature.set(t,this.scenarioData[t]),t==="geometry"&&this.scenarioData.geometry&&((0,h.default)(this.feature,this.scenarioData.geometry),this.guideLayer&&((0,i.removeSimulationTag)(this.feature,this.guideLayer),(0,i.addSimulationTag)(this.feature,this.guideLayer,this.layer)))}resetProperties(t,r=!1){const n=this.feature.get("originalData");let v;for(v of t||Object.keys(n))v==="geometry"?this.resetLocation(r):(this.feature.set(v,n[v]),r&&delete this.scenarioData[v]);this.checkScenarioData()}resetLocation(t=!1){const r=this.feature.get("originalData").geometry;r&&((0,h.default)(this.feature,r),t&&(delete this.scenarioData.geometry,this.checkScenarioData()))}checkScenarioData(){Object.keys(this.scenarioData).length===0&&(this.feature.unset("isModified"),(0,a.unByKey)(this.eventKeys.modifier)),this.guideLayer&&((0,i.removeSimulationTag)(this.feature,this.guideLayer),(this.feature.get("isSimulation")||this.feature.get("isModified"))&&this.scenario.isActive&&(0,i.addSimulationTag)(this.feature,this.guideLayer,this.layer))}clearScenarioData(){this.scenarioData={},this.feature.unset("isModified")}setProperties(t){for(const r in t)this.set(r,t[r]);this.feature.get("isSimulation")||(this.eventKeys.modifier=(0,f.getLayerSource)(this.layer).on("change",r=>{const n=r.target;if(!n.hasFeature(this.feature)&&this.scenario.isActive){const v=n.getFeatureById(this.feature.getId());v&&n.removeFeature(v),n.addFeature(this.feature)}})),this.feature.set("isModified",!0),this.guideLayer&&((0,i.removeSimulationTag)(this.feature,this.guideLayer),(0,i.addSimulationTag)(this.feature,this.guideLayer,this.layer))}getOriginalProperties(){return this.feature.get("originalData")}linkModifiedFeatureToSource(){this.eventKeys[this.feature.getId()]=(0,f.getLayerSource)(this.layer).on("change",()=>(0,o.default)(this.feature,this.layer))}set(t,r){this.scenarioData[t]=r,this.feature.set(t,r)}get(t){return this.scenarioData[t]}}},3721:function(j,N,d){var S=Object.create,p=Object.defineProperty,D=Object.getOwnPropertyDescriptor,x=Object.getOwnPropertyNames,L=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,F=(t,r)=>{for(var n in r)p(t,n,{get:r[n],enumerable:!0})},P=(t,r,n,v)=>{if(r&&typeof r=="object"||typeof r=="function")for(let O of x(r))!T.call(t,O)&&O!==n&&p(t,O,{get:()=>r[O],enumerable:!(v=D(r,O))||v.enumerable});return t},_=(t,r,n)=>(n=t!=null?S(L(t)):{},P(r||!t||!t.__esModule?p(n,"default",{value:t,enumerable:!0}):n,t)),b=t=>P(p({},"__esModule",{value:!0}),t),l={};F(l,{addSimulationTag:()=>a,clearGuideLayer:()=>s,featureTagStyle:()=>o,featureTagStyleMod:()=>h,removeSimulationTag:()=>c,toggleTagsOnLayerVisibility:()=>e}),j.exports=b(l);var f=d(40),i=_(d(21)),u=_(d(48));function o(t){var r;return new f.Style({text:new f.Text({font:"32px bold sans-serif",fill:new f.Fill({color:"#FC176B"}),stroke:new f.Stroke({width:4,color:"#000"}),text:"*",offsetX:10,offsetY:-5,placement:((r=t.getGeometry())==null?void 0:r.getType())==="Point"?"point":"line"})})}function h(t){var r;return new f.Style({text:new f.Text({font:"22px sans-serif",fill:new f.Fill({color:"#FC176B"}),stroke:new f.Stroke({width:1,color:"#000"}),text:"\u21C4",offsetX:15,offsetY:-12,placement:((r=t.getGeometry())==null?void 0:r.getType())==="Point"?"point":"line"})})}function a(t,r,n){if(!(t.constructor===i.default&&r.constructor===u.default&&n.constructor===u.default))return console.warn(`addSimulationTag: FeatureLayer must be of type "ol/Layer/Vector", got ${n.constructor}. Layer must be of type "ol/Layer/Vector", got ${r.constructor}. Feature must be of type "ol/Feature, got ${t.constructor}`),null;const v=r.getSource(),O=t.clone();return O.setId(t.getId()),O.setGeometry(t.getGeometry()),O.set("featureLayer",n),O.setStyle(null),v.addFeature(O),O}function c(t,r){if(!(t.constructor===i.default&&r.constructor===u.default)){console.warn(`removeSimulationTag: Layer must be of type "ol/Layer/Vector", got ${r.constructor}. Feature must be of type "ol/Feature, got ${t.constructor}`);return}const n=r.getSource(),v=n.getFeatureById(t?.getId());v&&n.removeFeature(v)}function s(t){if(!t.constructor===u.default){console.warn(`removeSimulationTag: Layer must be of type "ol/Layer/Vector", got ${t.constructor}.`);return}t.getSource().clear()}function e(t,r){const n=t.getSource().getFeatures(),v=new f.Style;for(const O of n)r.includes(O.get("featureLayer"))?O.setStyle():O.setStyle(v)}},3722:function(j,N,d){var S=Object.create,p=Object.defineProperty,D=Object.defineProperties,x=Object.getOwnPropertyDescriptor,L=Object.getOwnPropertyDescriptors,T=Object.getOwnPropertyNames,F=Object.getOwnPropertySymbols,P=Object.getPrototypeOf,_=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,l=(m,y,g)=>y in m?p(m,y,{enumerable:!0,configurable:!0,writable:!0,value:g}):m[y]=g,f=(m,y)=>{for(var g in y||(y={}))_.call(y,g)&&l(m,g,y[g]);if(F)for(var g of F(y))b.call(y,g)&&l(m,g,y[g]);return m},i=(m,y)=>D(m,L(y)),u=(m,y)=>{for(var g in y)p(m,g,{get:y[g],enumerable:!0})},o=(m,y,g,M)=>{if(y&&typeof y=="object"||typeof y=="function")for(let G of T(y))!_.call(m,G)&&G!==g&&p(m,G,{get:()=>y[G],enumerable:!(M=x(y,G))||M.enumerable});return m},h=(m,y,g)=>(g=m!=null?S(P(m)):{},o(y||!m||!m.__esModule?p(g,"default",{value:m,enumerable:!0}):g,m)),a=m=>o(p({},"__esModule",{value:!0}),m),c=(m,y,g)=>new Promise((M,G)=>{var J=C=>{try{E(g.next(C))}catch(I){G(I)}},A=C=>{try{E(g.throw(C))}catch(I){G(I)}},E=C=>C.done?M(C.value):Promise.resolve(C.value).then(J,A);E((g=g.apply(m,y)).next())}),s={};u(s,{default:()=>w}),j.exports=a(s);var e=h(d(3656)),t=h(d(3734)),r=d(3651),n=h(d(7)),v=h(d(4262)),O=h(d(121));class w{constructor(y,g,M){this.feature=y,this.layer=g,this.active=!1,this.activeDistrictLevels=M,this.scenario=null,this.setDefaultProperties(),this.computeContainingDistricts(M)}setDefaultProperties(){this.feature.set("isNeighborhood",!0),this.feature.set("styleId",(0,O.default)()),this.feature.setId((0,v.default)(i(f({},this.feature.getProperties()),{geom:this.feature.getGeometry()})))}renderFeature(){this.active||(this.modifyDistrictStats(),this.layer.getSource().addFeature(this.feature),this.active=!0)}hideFeature(){this.active&&(this.active=!1,this.resetDistrictStats(),this.layer.getSource().removeFeature(this.feature))}computeContainingDistricts(y){const g=(0,r.getAllContainingDistricts)(y,this.feature,!0);this.districts=g.map(M=>f({coverage:M.district.adminFeature?(0,t.default)(this.feature,M.district.adminFeature):1},M))}modifyDistrictStats(){return c(this,null,function*(){for(const y of this.districts){if(yield n.default.dispatch("Tools/DistrictSelector/getStatsByDistrict",{id:y.district.getId(),districtLevel:this.activeDistrictLevels.find(g=>g.label===y.districtLevel)}),y.district.statFeatures.length===0){console.warn(`No statistics have been loaded for ${y.district.getName()}. Cannot apply neighborhood stats.`);continue}this.updateStats(y)}n.default.dispatch("Tools/DistrictSelector/updateDistricts")})}updateStats(y){const g=(0,e.default)(y.district.statFeatures),M=new Date(this.feature.get("year")).getFullYear();let G,J;for(const A of this.feature.get("stats")||[])if(A.valueType==="absolute"){const E=y.district.statFeatures.find(C=>C.get("kategorie")===A.category);if(!E)continue;for(G of g.filter(C=>C>=M))J=parseFloat(E.get("jahr_"+G)),J&&E.set("jahr_"+G,J+Math.round(A.value*y.coverage));E.set("isModified",M)}else A.relation}resetDistrictStats(){const y=new Set(this.scenario.neighborhoods.map(g=>g.districts).flat());for(const g of y)g.district.statFeatures=g.district.originalStatFeatures.map(M=>M.clone());for(const g of this.scenario.neighborhoods)g.active&&g.modifyDistrictStats();n.default.dispatch("Tools/DistrictSelector/updateDistricts")}setFeature(y){this.hideFeature(),this.feature=y,this.setDefaultProperties(),this.renderFeature()}}},3731:function(j,N){var d=Object.defineProperty,S=Object.getOwnPropertyDescriptor,p=Object.getOwnPropertyNames,D=Object.getOwnPropertySymbols,x=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable,T=(i,u,o)=>u in i?d(i,u,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[u]=o,F=(i,u)=>{for(var o in u||(u={}))x.call(u,o)&&T(i,o,u[o]);if(D)for(var o of D(u))L.call(u,o)&&T(i,o,u[o]);return i},P=(i,u)=>{for(var o in u)d(i,o,{get:u[o],enumerable:!0})},_=(i,u,o,h)=>{if(u&&typeof u=="object"||typeof u=="function")for(let a of p(u))!x.call(i,a)&&a!==o&&d(i,a,{get:()=>u[a],enumerable:!(h=S(u,a))||h.enumerable});return i},b=i=>_(d({},"__esModule",{value:!0}),i),l={};P(l,{default:()=>f}),j.exports=b(l);function f(i,u=!0){if(!i.get("originalData")){const o=i.getProperties();Object.hasOwnProperty.call(o,"originalData")&&delete o.originalData,i.set("originalData",F({},o)),u&&(i.get("originalData").geometry=i.getGeometry().clone())}}},3732:function(j,N,d){var S=Object.create,p=Object.defineProperty,D=Object.getOwnPropertyDescriptor,x=Object.getOwnPropertyNames,L=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,F=(a,c)=>{for(var s in c)p(a,s,{get:c[s],enumerable:!0})},P=(a,c,s,e)=>{if(c&&typeof c=="object"||typeof c=="function")for(let t of x(c))!T.call(a,t)&&t!==s&&p(a,t,{get:()=>c[t],enumerable:!(e=D(c,t))||e.enumerable});return a},_=(a,c,s)=>(s=a!=null?S(L(a)):{},P(c||!a||!a.__esModule?p(s,"default",{value:a,enumerable:!0}):s,a)),b=a=>P(p({},"__esModule",{value:!0}),a),l=(a,c,s)=>new Promise((e,t)=>{var r=O=>{try{v(s.next(O))}catch(w){t(w)}},n=O=>{try{v(s.throw(O))}catch(w){t(w)}},v=O=>O.done?e(O.value):Promise.resolve(O.value).then(r,n);v((s=s.apply(a,c)).next())}),f={};F(f,{default:()=>h}),j.exports=b(f);var i=d(3650),u=_(d(4224));function o(a,c){return a.getFeatures().find(s=>(0,u.default)(s.getGeometry().getCoordinates(),c.getCoordinates()))}function h(a,c){return l(this,null,function*(){const s=(0,i.getLayerSource)(c),e=s.getFeatureById(a.getId())||o(s,a.get("originalData").geometry);e&&a!==e&&(s.removeFeature(e),s.addFeature(a))})}},3733:function(j,N,d){var S=Object.create,p=Object.defineProperty,D=Object.getOwnPropertyDescriptor,x=Object.getOwnPropertyNames,L=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,F=(a,c)=>{for(var s in c)p(a,s,{get:c[s],enumerable:!0})},P=(a,c,s,e)=>{if(c&&typeof c=="object"||typeof c=="function")for(let t of x(c))!T.call(a,t)&&t!==s&&p(a,t,{get:()=>c[t],enumerable:!(e=D(c,t))||e.enumerable});return a},_=(a,c,s)=>(s=a!=null?S(L(a)):{},P(c||!a||!a.__esModule?p(s,"default",{value:a,enumerable:!0}):s,a)),b=a=>P(p({},"__esModule",{value:!0}),a),l=(a,c,s)=>new Promise((e,t)=>{var r=O=>{try{v(s.next(O))}catch(w){t(w)}},n=O=>{try{v(s.throw(O))}catch(w){t(w)}},v=O=>O.done?e(O.value):Promise.resolve(O.value).then(r,n);v((s=s.apply(a,c)).next())}),f={};F(f,{default:()=>h}),j.exports=b(f);var i=_(d(7)),u=_(d(316)),o=d(3650);function h(a){return l(this,null,function*(){yield u.default.nextTick(),!(0,o.getLayerSource)(a.layer).hasFeature(a.feature)&&i.default.getters["Tools/FeaturesList/isFeatureActive"](a.feature)&&a.scenario.isActive&&(0,o.getLayerSource)(a.layer).addFeature(a.feature)})}},3734:function(j,N,d){var S=Object.create,p=Object.defineProperty,D=Object.getOwnPropertyDescriptor,x=Object.getOwnPropertyNames,L=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,F=(o,h)=>{for(var a in h)p(o,a,{get:h[a],enumerable:!0})},P=(o,h,a,c)=>{if(h&&typeof h=="object"||typeof h=="function")for(let s of x(h))!T.call(o,s)&&s!==a&&p(o,s,{get:()=>h[s],enumerable:!(c=D(h,s))||c.enumerable});return o},_=(o,h,a)=>(a=o!=null?S(L(o)):{},P(h||!o||!o.__esModule?p(a,"default",{value:o,enumerable:!0}):a,o)),b=o=>P(p({},"__esModule",{value:!0}),o),l={};F(l,{default:()=>u}),j.exports=b(l);var f=d(3651),i=_(d(7));function u(o,h){const a=i.default.getters["Maps/projectionCode"],c=(0,f.intersect)([o,h],!0,!0,a),s=o.getGeometry().getArea(),e=c?.getGeometry().getArea()||0;return Math.round((e/s+Number.EPSILON)*1e3)/1e3}},3759:function(j,N,d){var S=Object.create,p=Object.defineProperty,D=Object.getOwnPropertyDescriptor,x=Object.getOwnPropertyNames,L=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty,F=(s,e)=>{for(var t in e)p(s,t,{get:e[t],enumerable:!0})},P=(s,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of x(e))!T.call(s,n)&&n!==t&&p(s,n,{get:()=>e[n],enumerable:!(r=D(e,n))||r.enumerable});return s},_=(s,e,t)=>(t=s!=null?S(L(s)):{},P(e||!s||!s.__esModule?p(t,"default",{value:s,enumerable:!0}):t,s)),b=s=>P(p({},"__esModule",{value:!0}),s),l={};F(l,{default:()=>c}),j.exports=b(l);var f=_(d(3720)),i=_(d(3722)),u=d(3650),o=_(d(21)),h=d(3654),a=d(3653);class c{constructor(e,t,r={}){if(this.name=e,this.guideLayer=t,this.simulatedFeatures=[],this.modifiedFeatures=[],this.neighborhoods=[],this.isActive=r.isActive||!1,this.updated=new Date,r.simulatedFeatures)for(const n of r.simulatedFeatures)this.addFeature(n,this.isActive);if(r.modifiedFeatures)for(const n of r.modifiedFeatures)this.addModifiedFeature(n.feature,n.layer,n.scenarioData);if(r.neighborhoods)for(const n of r.neighborhoods)this.addNeighborhood(n,this.isActive)}addFeature(e,t=!0){return e?.constructor!==f.default?(console.error(`Scenario.addFeature: feature must be of Type ScenarioFeature. Got ${e?.constructor} instead.`),null):(e.scenario=this,this.simulatedFeatures.find(r=>r===e)||this.simulatedFeatures.push(e),t&&e.renderFeature(this.guideLayer),this.updateScenario(),e)}addModifiedFeature(e,t,r){if(e?.constructor!==o.default)return console.error(`Scenario.addModifiedFeature: feature must be of Type Feature. Got ${e?.constructor} instead.`),null;const n=new f.default(e,t,this.guideLayer,r);return n.scenario=this,n.linkModifiedFeatureToSource(),this.modifiedFeatures.push(n),n}modifyFeature(e,t,r){if(e?.constructor!==o.default){console.error(`Scenario.modifyFeature: feature must be of Type Feature. Got ${e?.constructor} instead.`);return}if(t?.constructor!==Object){console.error(`Scenario.modifyFeature: properties must be of Type Object. Got ${t?.constructor} instead.`);return}let n=this.getScenarioFeature(e);if(!n){if(!r)return;n=this.addModifiedFeature(e,r)}n.setProperties(t),this.updateScenario()}resetFeature(e,t,r=!1){const n=this.getScenarioFeature(e);n&&n.resetProperties(t,r),this.updateScenario()}resetAllFeatures(){let e;for(e of this.getAllFeatures())e.resetProperties();this.updateScenario()}resetAllDistricts(){let e;for(e of this.neighborhoods)e.hideFeature();this.updateScenario()}resetFeaturesByLayer(e,t,r=!1){const n=this.getScenarioFeaturesByLayer(e);let v;for(v of n)v.resetProperties(t,r);this.updateScenario()}addNeighborhood(e,t=!0){return e.constructor!==i.default?(console.error(`Scenario.addNeighborhood: neighborhood must be of Type ScenarioNeighborhood. Got ${e?.constructor} instead.`),null):(e.scenario=this,this.neighborhoods.push(e),t&&e.renderFeature(),this.updateScenario(),e)}hideScenario(){let e;this.isActive=!1,this.resetAllFeatures(),this.resetAllDistricts();for(e of this.simulatedFeatures)e.hideFeature();this.updateScenario()}prune(){this.hideScenario(),this.simulatedFeatures=[],this.modifiedFeatures=[],this.neighborhoods=[]}pruneSimulatedFeatures(){let e;for(e of this.simulatedFeatures)e.hideFeature();this.simulatedFeatures=[],this.updateScenario()}pruneNeighborhoods(){this.resetAllDistricts(),this.neighborhoods=[]}removeNeighborhood(e){const t=this.getNeighborhood(e);t&&(t.hideFeature(),this.neighborhoods=this.neighborhoods.filter(r=>r!==t)),this.updateScenario()}removeSimulatedFeature(e){const t=this.getScenarioFeature(e);t&&(t.hideFeature(),this.simulatedFeatures=this.simulatedFeatures.filter(r=>r!==t)),this.updateScenario()}restore(){this.isActive=!0;for(const e of this.simulatedFeatures)(0,u.getLayerSource)(e.layer).getFeatures().find(t=>t===e.feature)||e.renderFeature(this.guideLayer),e.restoreScenarioProperties();for(const e of this.modifiedFeatures)e.restoreScenarioProperties();for(const e of this.neighborhoods)e.renderFeature();this.updateScenario()}getAllFeatures(){return[...this.simulatedFeatures,...this.modifiedFeatures]}getSimulatedFeatures(){return[...this.simulatedFeatures]}getModifiedFeatures(){return[...this.modifiedFeatures]}getScenarioFeature(e,t){return t==="simulated"?this.getSimulatedScenarioFeature(e):t==="modified"?this.getModifiedScenarioFeature(e):this.simulatedFeatures.find(r=>r.feature===e)||this.modifiedFeatures.find(r=>r.feature===e)}getSimulatedScenarioFeature(e){return this.simulatedFeatures.find(t=>t.feature===e)}getModifiedScenarioFeature(e){return this.modifiedFeatures.find(t=>t.feature===e)}getNeighborhood(e){return this.neighborhoods.find(t=>t.feature===e)}getNeighborhoods(){return[...this.neighborhoods]}getScenarioFeaturesByLayer(e,t){return t==="simulated"?this.getSimulatedScenarioFeaturesByLayer(e):t==="modified"?this.getModifiedScenarioFeaturesByLayer(e):[...this.simulatedFeatures.filter(r=>r.layer===e),...this.modifiedFeatures.filter(r=>r.layer===e)]}getSimulatedScenarioFeaturesByLayer(e){return this.simulatedFeatures.filter(t=>t.layer===e)}getModifiedScenarioFeaturesByLayer(e){return this.modifiedFeatures.filter(t=>t.layer===e)}exportScenarioFeatures(){const e=(0,h.featuresToGeoJsonCollection)(this.simulatedFeatures.map(t=>t.feature));(0,a.downloadJsonToFile)(e,this.name+"_Simulierte_Einrichtungen.json")}exportScenarioNeighborhoods(){const e=(0,h.featuresToGeoJsonCollection)(this.neighborhoods.map(t=>t.feature));(0,a.downloadJsonToFile)(e,this.name+"_Simulierte_Wohnquartiere.json")}exportScenario(){const e=(0,h.featuresToGeoJsonCollection)([...this.getAllFeatures().map(t=>t.feature),...this.getNeighborhoods().map(t=>t.feature)]);(0,a.downloadJsonToFile)(e,this.name+"_Szenario.json")}updateScenario(){this.updated=new Date}getUpdated(){return this.updated}}},4286:function(j,N){function d(S){var p=new Error("Cannot find module '"+S+"'");throw p.code="MODULE_NOT_FOUND",p}d.keys=function(){return[]},d.resolve=d,j.exports=d,d.id=4286}}]);
