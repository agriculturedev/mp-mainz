(window.webpackJsonp=window.webpackJsonp||[]).push([[307,259],{3671:function(I,j){var L=Object.defineProperty,C=Object.getOwnPropertyDescriptor,g=Object.getOwnPropertyNames,A=Object.prototype.hasOwnProperty,$=(y,p)=>{for(var b in p)L(y,b,{get:p[b],enumerable:!0})},O=(y,p,b,c)=>{if(p&&typeof p=="object"||typeof p=="function")for(let m of g(p))!A.call(y,m)&&m!==b&&L(y,m,{get:()=>p[m],enumerable:!(c=C(p,m))||c.enumerable});return y},S=y=>O(L({},"__esModule",{value:!0}),y),_={};$(_,{default:()=>w}),I.exports=S(_);class w{constructor({id:p="cg",name:b,data:c,type:m,beginAtZero:x=!1,stacked:t=!1,scaleLabels:e,color:o="blue",source:i="",sub:a=!1,sub_graph:r,sub_index:s,sub_length:d,options:l}){if(!(b&&c&&m&&typeof b=="string"&&(typeof m=="string"||Array.isArray(m))&&typeof c=="object"))throw new EvalError(`ChartDataset: 'name', 'data' and 'type' musst be provided in the options. Got ${b}, ${c} and ${m} instead`);this.type=m,this.id=p,this.name=b,this.color=o,this.data=c,this.scaleLabels=e,this.source=i,this.source=i,this.beginAtZero=x,this.stacked=t,this.sub=a,this.sub_graph=r,this.sub_index=s,this.sub_length=d,this.options=l,this.cgid=p+"-"+b}}},3950:function(I,j,L){var C=Object.create,g=Object.defineProperty,A=Object.getOwnPropertyDescriptor,$=Object.getOwnPropertyNames,O=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty,_=(t,e)=>{for(var o in e)g(t,o,{get:e[o],enumerable:!0})},w=(t,e,o,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of $(e))!S.call(t,a)&&a!==o&&g(t,a,{get:()=>e[a],enumerable:!(i=A(e,a))||i.enumerable});return t},y=(t,e,o)=>(o=t!=null?C(O(t)):{},w(e||!t||!t.__esModule?g(o,"default",{value:t,enumerable:!0}):o,t)),p=t=>w(g({},"__esModule",{value:!0}),t),b={};_(b,{createHistogram:()=>m,default:()=>x}),I.exports=p(b);var c=y(L(3671));function m(t){let e=t.filter(h=>!isNaN(parseInt(h.score.value,10))).map(h=>parseInt(h.score.value,10));const o=Math.max(...e),i=Math.min(...e),a=o-i,r=Math.ceil(a/100)<100?100:1e3,s=i/100<10?100:1e3,d=Math.floor(i/s)*s,l=Math.ceil(a/r),n=new Array(l).fill(d).map((h,v)=>h+v*r),u=n[n.length-1]+r,f=[...n];o>u&&(n.push(u),f.push(u));for(let h=n.length-1;h>=0;h--){const v=e.filter(D=>D<n[h]);f[h]=e.length-v.length,e=v}return{quantiles:n,data:f}}var x={showDistanceScoreForItem(t){const e=Object.keys(t.score.distance).length>3?"RadarChart":"BarChart",o={labels:Object.keys(t.score.distance.facilities).map(a=>t.score.distance.facilities[a].layerName),datasets:[{label:t.name,data:Object.keys(t.score.distance.facilities).map(a=>{var r;return(r=t.score.distance.facilities[a].value)==null?void 0:r.toFixed(1)})}]},i=new c.default({id:"sb-"+t.key,name:`${this.$t("additional:modules.tools.cosi.featuresList.scoresDialogTitle")} - Gewichteter Durchschnitt: ${t.score.distance.average.toLocaleString(this.currentLocale)} (Standortanalyse)`,type:e,color:"rainbow",source:"Standortanalyse",scaleLabels:[this.$t("additional:modules.tools.cosi.featuresList.distanceScoreChartYLabel"),""],data:o});this.channelGraphData(i)},showDistanceScoresForSelected(t){const e=t.length>2?"RadarChart":"BarChart",o={labels:t.map(a=>a.id),datasets:this.getActiveItems().map(a=>({label:a.name,data:t.map(r=>a.score.distance.facilities[r.layerId].value),tooltip:`Gewichteter Durchschnitt: ${a.score.distance.average.toLocaleString("de-DE")}`}))},i=new c.default({id:"sb-"+this.getActiveItems().map(a=>a.key).join(","),name:`${this.$t("additional:modules.tools.cosi.featuresList.scoresDialogTitle")} (Standortanalyse)`,type:e,color:"rainbow",source:"Standortanalyse",scaleLabels:[this.$t("additional:modules.tools.cosi.featuresList.distanceScoreChartYLabel"),""],data:o});this.channelGraphData(i)},showDistanceScoreHistogram(t){const e=m(this.getActiveItems()),o={labels:e.quantiles.map(r=>Math.round(r)),datasets:[{data:e.data,label:t.map(r=>r.id).join(", "),barPercentage:1,categoryPercentage:1}]},i={scales:{xAxes:[{ticks:{labelOffset:-20},scaleLabel:{display:!0,labelString:""}}],yAxes:[{scaleLabel:{display:!0,labelString:""}}]},tooltips:{callbacks:{title:(r,s)=>"> "+s.labels[r[0].index]+"m"}}},a=new c.default({id:"sb-histogram",name:this.$t("additional:modules.tools.cosi.featuresList.scoresDialogHistogramTitle"),type:"BarChart",color:"rainbow",source:"Standortanalyse",scaleLabels:[this.$t("additional:modules.tools.cosi.featuresList.count"),this.$t("additional:modules.tools.cosi.featuresList.distanceScore")],data:o,options:i,beginAtZero:!0});this.channelGraphData(a)},createCharts(){this.sumUpLayers?this.createChartsForLayers():this.createChartsForTypes()},createChartsForLayers(){const t=this.getActiveItems(),e=[...this.numericalColumns,{value:"count",text:"Anzahl"}],o=e.map(i=>{const a=i.value==="count"?this.getActiveLayers():this.getActiveLayersWithNumValue(i.value),r=i.value==="count"?t:t.filter(l=>!!l[i.value]),s=[...new Set(r.map(l=>l.district))].sort(),d={labels:s,datasets:a.map(l=>({label:l.id,data:s.map(n=>r.reduce((u,f)=>f.district===n&&f.layerId===l.layerId?i.value==="count"?u+1:u+parseFloat(f[i.value]):u,0))}))};return new c.default({id:this.id+"-"+i.value+"-allLayers",name:i.text,type:"BarChart",color:"rainbow",source:this.$t("additional:modules.tools.cosi.featuresList.title"),scaleLabels:[i.text,this.$t("additional:modules.tools.cosi.featuresList.colDistrict")],data:d,beginAtZero:!0})});this.channelGraphData(o)},createChartsForTypes(){const t=this.getActiveItems(),{districts:e,types:o}=this.getDistrictsAndTypes(t),i=this.getActiveLayers(),a=i.reduce((r,s)=>{const d=this.distanceScoreEnabled?[...s.numericalValues,{id:"distanceScore",name:"Anbindng"},{id:"count",name:"Anzahl"}]:[...s.numericalValues,{id:"count",name:"Anzahl"}],l=d.map(n=>{const u=t.filter(h=>h.layerId===s.layerId),f={labels:e[s.layerId],datasets:o[s.layerId].map(h=>({label:h||s.id,data:e[s.layerId].map(v=>u.reduce((D,P)=>P.district===v&&P.type===h?n.id==="count"?D+1:D+parseFloat(P[n.id]):D,0))}))};return new c.default({id:this.id+"-"+s.layerId+"-"+n.id,name:s.id,type:"BarChart",color:"rainbow",source:this.$t("additional:modules.tools.cosi.featuresList.title"),scaleLabels:[n.name,this.$t("additional:modules.tools.cosi.featuresList.colDistrict")],data:f,beginAtZero:!0})});return[...r,...l]},[]);this.channelGraphData(a)},createDipasCharts(){const t=[];this.createDipasCommentsNumberGraphs(t),this.createDipasTimeGraphs(t),this.createDipasScatterGraphs(t),this.channelGraphData(t)},createDipasCommentsNumberGraphs(t){const e=this.getActiveDipasItems(),o=this.getDistrictsAndTypes(e).types,i=this.getActiveDipasLayers(),a=i.map(r=>{const s=this.sumUpLayers?[...new Set(Object.values(o).flat())]:o[r.layerId],d={labels:s,datasets:[{label:this.$t("additional:modules.tools.cosi.featuresList.dipas.comments"),data:s.map(l=>e.reduce((n,u)=>this.sumUpLayers?u.type===l?n+parseInt(u.commentsNumber,10):n:u.layerId===r.layerId&&u.type===l?n+parseInt(u.commentsNumber,10):n,0))}]};return new c.default({id:this.id+"-"+r.layerId+"-commentsNumberChart",name:r.id.replace(" contributions","")+this.$t("additional:modules.tools.cosi.featuresList.dipas.commentsPerCategory"),type:"BarChart",color:"rainbow",source:this.$t("additional:modules.tools.cosi.dipas.title"),scaleLabels:[this.$t("additional:modules.tools.cosi.featuresList.dipas.comments"),this.$t("additional:modules.tools.cosi.featuresList.dipas.category")],data:d,beginAtZero:!0})});t.push(...a)},createDipasTimeGraphs(t){const e=this.getActiveDipasItems(),o=this.getActiveDipasLayers(),i=o.map(a=>{const r=e.filter(l=>this.sumUpLayers||l.layerId===a.layerId).map(l=>l.feature.values_.dateCreated).sort(),s={labels:r,datasets:[{label:this.$t("additional:modules.tools.cosi.featuresList.dipas.contributions"),data:r.map((l,n)=>({t:l,y:n+1}))}]},d=this.currentLocale;return new c.default({id:this.id+"-"+a.layerId+"-timeChart",name:a.id.replace(" contributions","")+this.$t("additional:modules.tools.cosi.featuresList.dipas.contributionsOverTime"),type:"LineChart",color:"rainbow",source:this.$t("additional:modules.tools.cosi.dipas.title"),scaleLabels:[this.$t("additional:modules.tools.cosi.featuresList.dipas.contributions"),this.$t("additional:modules.tools.cosi.featuresList.dipas.contributions")],options:{scales:{xAxes:[{type:"time"}]},tooltips:{callbacks:{title:function(l){return new Date(l[0].label).toLocaleString(d)}}}},data:s,beginAtZero:!0})});t.push(...i)},createDipasScatterGraphs(t){const e=this.getActiveDipasItems(),o=this.getActiveDipasLayers(),i=o.map(a=>{const r={datasets:[{label:this.$t("additional:modules.tools.cosi.featuresList.dipas.commentsVoting"),data:e.filter(s=>this.sumUpLayers||s.layerId===a.layerId).map(s=>({x:parseInt(s.votingPro,10)-parseInt(s.votingContra,10),y:parseInt(s.commentsNumber,10),name:s.name}))}]};return new c.default({id:this.id+"-"+a.layerId+"-scatterChart",name:a.id.replace(" contributions","")+this.$t("additional:modules.tools.cosi.featuresList.dipas.commentsVotingText"),type:"ScatterChart",color:"rainbow",source:this.$t("additional:modules.tools.cosi.dipas.title"),scaleLabels:[this.$t("additional:modules.tools.cosi.featuresList.dipas.comments"),this.$t("additional:modules.tools.cosi.featuresList.dipas.voting")],options:{tooltips:{callbacks:{label:function(s,d){const l=s.index;return d.datasets[0].data[l].name},title:function(s,d){return d.datasets[0].label+" ("+s[0].yLabel+"/"+s[0].xLabel+")"},footer:()=>null}}},data:r,beginAtZero:!0})});t.push(...i)}}}}]);
