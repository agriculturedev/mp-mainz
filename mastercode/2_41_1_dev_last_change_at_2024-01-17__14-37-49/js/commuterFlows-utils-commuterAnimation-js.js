(window.webpackJsonp=window.webpackJsonp||[]).push([[237],{3861:function(m,S,h){var g=Object.create,y=Object.defineProperty,P=Object.getOwnPropertyDescriptor,F=Object.getOwnPropertyNames,O=Object.getPrototypeOf,R=Object.prototype.hasOwnProperty,j=(r,e)=>{for(var t in e)y(r,t,{get:e[t],enumerable:!0})},c=(r,e,t,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of F(e))!R.call(r,i)&&i!==t&&y(r,i,{get:()=>e[i],enumerable:!(a=P(e,i))||a.enumerable});return r},T=(r,e,t)=>(t=r!=null?g(O(r)):{},c(e||!r||!r.__esModule?y(t,"default",{value:r,enumerable:!0}):t,r)),x=r=>c(y({},"__esModule",{value:!0}),r),v={};j(v,{CommuterAnimation:()=>s}),m.exports=x(v);var p=h(40),b=h(140),w=T(h(21)),D=h(454);class s{constructor(e,t,a,i,o,n){this.featureList=e,this.speeds=t,this.layers={bubbles:a,animation:i},this.layerAnimation=i,this.ol=o,this.styles=[],this.startTime=null,this.ol.hideLayer(this.layers.animation),this.ol.clearLayer(this.layers.animation),typeof s.moveFeatureRef=="function"&&this.ol.unPostRender(this.layers.animation,s.moveFeatureRef),Array.isArray(e)&&e.length&&e.forEach((l,u)=>{const f=l.get("coordinate"),d=new w.default(new b.Point(f));d.setStyle(new p.Style({image:new p.Circle({radius:0})})),this.ol.addFeature(this.layers.animation,d),this.styles.push(n(l,u))}),this.speedsTotal=0,Array.isArray(t)&&t.forEach(l=>{this.speedsTotal+=l})}start(){this.ol.hideLayer(this.layers.bubbles),this.ol.showLayer(this.layers.animation),typeof s.moveFeatureRef=="function"&&this.ol.unPostRender(this.layers.animation,s.moveFeatureRef),s.moveFeatureRef=e=>this.moveFeature(e),this.ol.onPostRender(this.layers.animation,s.moveFeatureRef),this.startTime=new Date().getTime(),this.ol.render()}stop(){this.startTime=null,typeof s.moveFeatureRef=="function"&&(this.ol.unPostRender(this.layers.animation,s.moveFeatureRef),s.moveFeatureRef=null),this.ol.hideLayer(this.layers.animation),this.ol.showLayer(this.layers.bubbles)}isRunning(){return this.startTime!==null}moveFeature(e){const t=(0,D.getVectorContext)(e),a=e.frameState;if(this.startTime){const i=a.time-this.startTime;this.featureList.forEach((o,n)=>{const l=this.getDistance(i,this.speedsTotal,this.speeds),u=o.getGeometry().getCoordinateAt(l),f=new w.default(new b.Point(u));t.drawFeature(f,this.styles[n])}),this.ol.render()}}getDistance(e,t,a){if(!e||typeof e!="number"||!t||typeof t!="number"||!Array.isArray(a)||!a.length)return 0;const i=e%t;let o=0,n=0;for(;o>=0;){if(n+=a[o],n>i){n=a[o]-(n-i);break}o++}return o%2===0?1/a[o]*n:1-1/a[o]*n}}}}]);
