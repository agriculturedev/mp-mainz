(window.webpackJsonp=window.webpackJsonp||[]).push([[343,350,353,354,356,422,431],{3650:function(m,D,g){var w=Object.create,h=Object.defineProperty,O=Object.getOwnPropertyDescriptor,P=Object.getOwnPropertyNames,j=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty,S=(n,o,a,i)=>{if(o&&typeof o=="object"||typeof o=="function")for(let l of P(o))!b.call(n,l)&&l!==a&&h(n,l,{get:()=>o[l],enumerable:!(i=O(o,l))||i.enumerable});return n},d=(n,o,a)=>(a=n!=null?w(j(n)):{},S(o||!n||!n.__esModule?h(a,"default",{value:n,enumerable:!0}):a,n)),_=d(g(106));function v(n){var o;if(typeof n!="object"||n===null||typeof n.getSource!="function"||typeof((o=n.getSource())==null?void 0:o.getFeatures)!="function")return console.error("utils/layer/getLayerSource: layer must be a layer with a vector source",n),null;const a=n.getSource();return a.constructor===_.default?a.getSource():a}m.exports={getLayerSource:v}},3662:function(m,D){var g=Object.defineProperty,w=Object.getOwnPropertyDescriptor,h=Object.getOwnPropertyNames,O=Object.prototype.hasOwnProperty,P=(_,v)=>{for(var n in v)g(_,n,{get:v[n],enumerable:!0})},j=(_,v,n,o)=>{if(v&&typeof v=="object"||typeof v=="function")for(let a of h(v))!O.call(_,a)&&a!==n&&g(_,a,{get:()=>v[a],enumerable:!(o=w(v,a))||o.enumerable});return _},b=_=>j(g({},"__esModule",{value:!0}),_),S={};P(S,{default:()=>d}),m.exports=b(S);function d(_,v){const n=_.getGeometry();if(Array.isArray(v)&&v.length===2&&typeof v[0]=="number"&&typeof v[1]=="number"){const o=n.getExtent().getCenter(),a=v[0]-o[0],i=v[1]-o[1];n.translate(a,i)}else _.setGeometry(v.clone())}},3720:function(m,D,g){var w=Object.create,h=Object.defineProperty,O=Object.getOwnPropertyDescriptor,P=Object.getOwnPropertyNames,j=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty,S=(y,e)=>{for(var r in e)h(y,r,{get:e[r],enumerable:!0})},d=(y,e,r,c)=>{if(e&&typeof e=="object"||typeof e=="function")for(let f of P(e))!b.call(y,f)&&f!==r&&h(y,f,{get:()=>e[f],enumerable:!(c=O(e,f))||c.enumerable});return y},_=(y,e,r)=>(r=y!=null?w(j(y)):{},d(e||!y||!y.__esModule?h(r,"default",{value:y,enumerable:!0}):r,y)),v=y=>d(h({},"__esModule",{value:!0}),y),n={};S(n,{default:()=>s}),m.exports=v(n);var o=g(3650),a=g(3721),i=_(g(3731)),l=_(g(3732)),F=_(g(3662)),t=g(152),u=_(g(3733));class s{constructor(e,r,c,f){this.feature=e,this.layer=r,this.guideLayer=c,this.scenarioData=f||{},this.scenario=null,this.eventKeys={},(0,i.default)(this.feature)}renderFeature(e){(0,o.getLayerSource)(this.layer).addFeature(this.feature),this.eventKeys[this.feature.getId()]=(0,o.getLayerSource)(this.layer).on("change",()=>{(0,u.default)(this)}),(e||this.guideLayer)&&(this.guideLayer=e||this.guideLayer,(0,a.addSimulationTag)(this.feature,this.guideLayer,this.layer))}hideFeature(){const e=(0,o.getLayerSource)(this.layer);(0,t.unByKey)(this.eventKeys.modifier),(0,t.unByKey)(this.eventKeys[this.feature.getId()]),e.getFeatureById(this.feature.getId())&&e.removeFeature(this.feature),this.guideLayer&&(0,a.removeSimulationTag)(this.feature,this.guideLayer)}restoreScenarioProperties(){for(const e in this.scenarioData)this.feature.set(e,this.scenarioData[e]),e==="geometry"&&this.scenarioData.geometry&&((0,F.default)(this.feature,this.scenarioData.geometry),this.guideLayer&&((0,a.removeSimulationTag)(this.feature,this.guideLayer),(0,a.addSimulationTag)(this.feature,this.guideLayer,this.layer)))}resetProperties(e,r=!1){const c=this.feature.get("originalData");let f;for(f of e||Object.keys(c))f==="geometry"?this.resetLocation(r):(this.feature.set(f,c[f]),r&&delete this.scenarioData[f]);this.checkScenarioData()}resetLocation(e=!1){const r=this.feature.get("originalData").geometry;r&&((0,F.default)(this.feature,r),e&&(delete this.scenarioData.geometry,this.checkScenarioData()))}checkScenarioData(){Object.keys(this.scenarioData).length===0&&(this.feature.unset("isModified"),(0,t.unByKey)(this.eventKeys.modifier)),this.guideLayer&&((0,a.removeSimulationTag)(this.feature,this.guideLayer),(this.feature.get("isSimulation")||this.feature.get("isModified"))&&this.scenario.isActive&&(0,a.addSimulationTag)(this.feature,this.guideLayer,this.layer))}clearScenarioData(){this.scenarioData={},this.feature.unset("isModified")}setProperties(e){for(const r in e)this.set(r,e[r]);this.feature.get("isSimulation")||(this.eventKeys.modifier=(0,o.getLayerSource)(this.layer).on("change",r=>{const c=r.target;if(!c.hasFeature(this.feature)&&this.scenario.isActive){const f=c.getFeatureById(this.feature.getId());f&&c.removeFeature(f),c.addFeature(this.feature)}})),this.feature.set("isModified",!0),this.guideLayer&&((0,a.removeSimulationTag)(this.feature,this.guideLayer),(0,a.addSimulationTag)(this.feature,this.guideLayer,this.layer))}getOriginalProperties(){return this.feature.get("originalData")}linkModifiedFeatureToSource(){this.eventKeys[this.feature.getId()]=(0,o.getLayerSource)(this.layer).on("change",()=>(0,l.default)(this.feature,this.layer))}set(e,r){this.scenarioData[e]=r,this.feature.set(e,r)}get(e){return this.scenarioData[e]}}},3721:function(m,D,g){var w=Object.create,h=Object.defineProperty,O=Object.getOwnPropertyDescriptor,P=Object.getOwnPropertyNames,j=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty,S=(e,r)=>{for(var c in r)h(e,c,{get:r[c],enumerable:!0})},d=(e,r,c,f)=>{if(r&&typeof r=="object"||typeof r=="function")for(let p of P(r))!b.call(e,p)&&p!==c&&h(e,p,{get:()=>r[p],enumerable:!(f=O(r,p))||f.enumerable});return e},_=(e,r,c)=>(c=e!=null?w(j(e)):{},d(r||!e||!e.__esModule?h(c,"default",{value:e,enumerable:!0}):c,e)),v=e=>d(h({},"__esModule",{value:!0}),e),n={};S(n,{addSimulationTag:()=>t,clearGuideLayer:()=>s,featureTagStyle:()=>l,featureTagStyleMod:()=>F,removeSimulationTag:()=>u,toggleTagsOnLayerVisibility:()=>y}),m.exports=v(n);var o=g(40),a=_(g(21)),i=_(g(48));function l(e){var r;return new o.Style({text:new o.Text({font:"32px bold sans-serif",fill:new o.Fill({color:"#FC176B"}),stroke:new o.Stroke({width:4,color:"#000"}),text:"*",offsetX:10,offsetY:-5,placement:((r=e.getGeometry())==null?void 0:r.getType())==="Point"?"point":"line"})})}function F(e){var r;return new o.Style({text:new o.Text({font:"22px sans-serif",fill:new o.Fill({color:"#FC176B"}),stroke:new o.Stroke({width:1,color:"#000"}),text:"\u21C4",offsetX:15,offsetY:-12,placement:((r=e.getGeometry())==null?void 0:r.getType())==="Point"?"point":"line"})})}function t(e,r,c){if(!(e.constructor===a.default&&r.constructor===i.default&&c.constructor===i.default))return console.warn(`addSimulationTag: FeatureLayer must be of type "ol/Layer/Vector", got ${c.constructor}. Layer must be of type "ol/Layer/Vector", got ${r.constructor}. Feature must be of type "ol/Feature, got ${e.constructor}`),null;const f=r.getSource(),p=e.clone();return p.setId(e.getId()),p.setGeometry(e.getGeometry()),p.set("featureLayer",c),p.setStyle(null),f.addFeature(p),p}function u(e,r){if(!(e.constructor===a.default&&r.constructor===i.default)){console.warn(`removeSimulationTag: Layer must be of type "ol/Layer/Vector", got ${r.constructor}. Feature must be of type "ol/Feature, got ${e.constructor}`);return}const c=r.getSource(),f=c.getFeatureById(e?.getId());f&&c.removeFeature(f)}function s(e){if(!e.constructor===i.default){console.warn(`removeSimulationTag: Layer must be of type "ol/Layer/Vector", got ${e.constructor}.`);return}e.getSource().clear()}function y(e,r){const c=e.getSource().getFeatures(),f=new o.Style;for(const p of c)r.includes(p.get("featureLayer"))?p.setStyle():p.setStyle(f)}},3731:function(m,D){var g=Object.defineProperty,w=Object.getOwnPropertyDescriptor,h=Object.getOwnPropertyNames,O=Object.getOwnPropertySymbols,P=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable,b=(a,i,l)=>i in a?g(a,i,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[i]=l,S=(a,i)=>{for(var l in i||(i={}))P.call(i,l)&&b(a,l,i[l]);if(O)for(var l of O(i))j.call(i,l)&&b(a,l,i[l]);return a},d=(a,i)=>{for(var l in i)g(a,l,{get:i[l],enumerable:!0})},_=(a,i,l,F)=>{if(i&&typeof i=="object"||typeof i=="function")for(let t of h(i))!P.call(a,t)&&t!==l&&g(a,t,{get:()=>i[t],enumerable:!(F=w(i,t))||F.enumerable});return a},v=a=>_(g({},"__esModule",{value:!0}),a),n={};d(n,{default:()=>o}),m.exports=v(n);function o(a,i=!0){if(!a.get("originalData")){const l=a.getProperties();Object.hasOwnProperty.call(l,"originalData")&&delete l.originalData,a.set("originalData",S({},l)),i&&(a.get("originalData").geometry=a.getGeometry().clone())}}},3732:function(m,D,g){var w=Object.create,h=Object.defineProperty,O=Object.getOwnPropertyDescriptor,P=Object.getOwnPropertyNames,j=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty,S=(t,u)=>{for(var s in u)h(t,s,{get:u[s],enumerable:!0})},d=(t,u,s,y)=>{if(u&&typeof u=="object"||typeof u=="function")for(let e of P(u))!b.call(t,e)&&e!==s&&h(t,e,{get:()=>u[e],enumerable:!(y=O(u,e))||y.enumerable});return t},_=(t,u,s)=>(s=t!=null?w(j(t)):{},d(u||!t||!t.__esModule?h(s,"default",{value:t,enumerable:!0}):s,t)),v=t=>d(h({},"__esModule",{value:!0}),t),n=(t,u,s)=>new Promise((y,e)=>{var r=p=>{try{f(s.next(p))}catch(L){e(L)}},c=p=>{try{f(s.throw(p))}catch(L){e(L)}},f=p=>p.done?y(p.value):Promise.resolve(p.value).then(r,c);f((s=s.apply(t,u)).next())}),o={};S(o,{default:()=>F}),m.exports=v(o);var a=g(3650),i=_(g(4224));function l(t,u){return t.getFeatures().find(s=>(0,i.default)(s.getGeometry().getCoordinates(),u.getCoordinates()))}function F(t,u){return n(this,null,function*(){const s=(0,a.getLayerSource)(u),y=s.getFeatureById(t.getId())||l(s,t.get("originalData").geometry);y&&t!==y&&(s.removeFeature(y),s.addFeature(t))})}},3733:function(m,D,g){var w=Object.create,h=Object.defineProperty,O=Object.getOwnPropertyDescriptor,P=Object.getOwnPropertyNames,j=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty,S=(t,u)=>{for(var s in u)h(t,s,{get:u[s],enumerable:!0})},d=(t,u,s,y)=>{if(u&&typeof u=="object"||typeof u=="function")for(let e of P(u))!b.call(t,e)&&e!==s&&h(t,e,{get:()=>u[e],enumerable:!(y=O(u,e))||y.enumerable});return t},_=(t,u,s)=>(s=t!=null?w(j(t)):{},d(u||!t||!t.__esModule?h(s,"default",{value:t,enumerable:!0}):s,t)),v=t=>d(h({},"__esModule",{value:!0}),t),n=(t,u,s)=>new Promise((y,e)=>{var r=p=>{try{f(s.next(p))}catch(L){e(L)}},c=p=>{try{f(s.throw(p))}catch(L){e(L)}},f=p=>p.done?y(p.value):Promise.resolve(p.value).then(r,c);f((s=s.apply(t,u)).next())}),o={};S(o,{default:()=>F}),m.exports=v(o);var a=_(g(7)),i=_(g(316)),l=g(3650);function F(t){return n(this,null,function*(){yield i.default.nextTick(),!(0,l.getLayerSource)(t.layer).hasFeature(t.feature)&&a.default.getters["Tools/FeaturesList/isFeatureActive"](t.feature)&&t.scenario.isActive&&(0,l.getLayerSource)(t.layer).addFeature(t.feature)})}}}]);
