(window.webpackJsonp=window.webpackJsonp||[]).push([[53,147,148,319,320,321,322,323,324,325,427],{219:function(T,x,o){var s=Object.create,p=Object.defineProperty,w=Object.getOwnPropertyDescriptor,j=Object.getOwnPropertyNames,S=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty,_=(E,y)=>{for(var h in y)p(E,h,{get:y[h],enumerable:!0})},I=(E,y,h,O)=>{if(y&&typeof y=="object"||typeof y=="function")for(let f of j(y))!b.call(E,f)&&f!==h&&p(E,f,{get:()=>y[f],enumerable:!(O=w(y,f))||O.enumerable});return E},c=(E,y,h)=>(h=E!=null?s(S(E)):{},I(y||!E||!E.__esModule?p(h,"default",{value:E,enumerable:!0}):h,E)),a=E=>I(p({},"__esModule",{value:!0}),E),i={};_(i,{default:()=>v}),T.exports=a(i);var e=c(o(5426)),r=c(o(3966)),u=c(o(3967)),n=c(o(3968)),v={component:e.default,store:r.default,locales:{de:u.default,en:n.default}}},3649:function(T,x,o){(function(s){var p=Object.defineProperty,w=Object.getOwnPropertyDescriptor,j=Object.getOwnPropertyNames,S=Object.prototype.hasOwnProperty,b=(t,l)=>{for(var g in l)p(t,g,{get:l[g],enumerable:!0})},_=(t,l,g,D)=>{if(l&&typeof l=="object"||typeof l=="function")for(let M of j(l))!S.call(t,M)&&M!==g&&p(t,M,{get:()=>l[M],enumerable:!(D=w(l,M))||D.enumerable});return t},I=t=>_(p({},"__esModule",{value:!0}),t),c={};b(c,{addByMouseHover:()=>B,addFolder:()=>m,addModelsByAttributes:()=>h,addVectorLayer:()=>P,closeAllExpandedFolder:()=>E,getCollection:()=>O,getItemByAttributes:()=>f,getItemsByAttributes:()=>d,getModelByAttributes:()=>n,getServiceUrl:()=>e,groupBy:()=>U,offSearchbar:()=>i,onFeaturesLoaded:()=>L,onResetFeatures:()=>C,onSearchbar:()=>a,onShowAllFeatures:()=>u,onShowFeaturesById:()=>r,removeItem:()=>A,removeModelsById:()=>y,renderTree:()=>v}),T.exports=I(c);function a(t){s.on("Searchbar","hit",t)}function i(){s.off("Searchbar","hit")}function e(t){return s.request("RestReader","getServiceById",t).get("url")}function r(t){s.on("ModelList","showFeaturesById",t)}function u(t){s.on("ModelList","showAllFeatures",t)}function n(t){return s.request("ModelList","getModelByAttributes",t)}function v(){s.trigger("ModelList","renderTree")}function E(){s.trigger("ModelList","closeAllExpandedFolder")}function y(t){s.trigger("ModelList","removeModelsById",t)}function h(t){s.trigger("ModelList","addModelsByAttributes",t)}function O(){return s.request("ModelList","getCollection")}function f(t){return s.request("Parser","getItemByAttributes",t)}function d(t){return s.request("Parser","getItemsByAttributes",t)}function m(t,l,g,D){s.trigger("Parser","addFolder",t,l,g,D)}function P(t,l,g,D,M,F,R){s.trigger("Parser","addVectorLayer",t,l,g,D,M,F,R)}function A(t){s.trigger("Parser","removeItem",t)}function L(t){s.on("VectorLayer","featuresLoaded",t)}function C(t){s.on("VectorLayer","resetFeatures",t)}function B(t){s.trigger("MouseHover","add",t)}function U(t,l){return s.request("Util","groupBy",t,l)}}).call(this,o(3))},3679:function(T,x){var o=Object.defineProperty,s=Object.getOwnPropertyDescriptor,p=Object.getOwnPropertyNames,w=Object.prototype.hasOwnProperty,j=(c,a)=>{for(var i in a)o(c,i,{get:a[i],enumerable:!0})},S=(c,a,i,e)=>{if(a&&typeof a=="object"||typeof a=="function")for(let r of p(a))!w.call(c,r)&&r!==i&&o(c,r,{get:()=>a[r],enumerable:!(e=s(a,r))||e.enumerable});return c},b=c=>S(o({},"__esModule",{value:!0}),c),_={};j(_,{default:()=>I}),T.exports=b(_);var I={active:!1,deactivateGFI:!1,icon:"bi-upload",id:"reportTemplates",name:"Report Templates",onlyDesktop:!0,renderToWindow:!0,resizableWindow:!0,title:"Report Templates",supportedTools:[{value:"AccessibilityAnalysis",title:"Erreichbarkeitsanalyse"},{value:"Dashboard",title:"Dashboard"}],templateItems:[],editingTool:{toolName:null,templateItemsIndex:null,aborted:!1},readmeUrl:{"en-US":"https://bitbucket.org/geowerkstatt-hamburg/addons/src/dev/cosi/manuals/024reporttool.md","de-DE":"https://bitbucket.org/geowerkstatt-hamburg/addons/src/dev/cosi/manuals/024reporttool.md"}}},3739:function(T,x){var o=Object.defineProperty,s=Object.getOwnPropertyDescriptor,p=Object.getOwnPropertyNames,w=Object.prototype.hasOwnProperty,j=(a,i)=>{for(var e in i)o(a,e,{get:i[e],enumerable:!0})},S=(a,i,e,r)=>{if(i&&typeof i=="object"||typeof i=="function")for(let u of p(i))!w.call(a,u)&&u!==e&&o(a,u,{get:()=>i[u],enumerable:!(r=s(i,u))||r.enumerable});return a},b=a=>S(o({},"__esModule",{value:!0}),a),_={};j(_,{default:()=>c}),T.exports=b(_);function I(a,i){if(typeof a!="string")return{success:!1,message:"toolName must be a string"};if(typeof i!="object")return{success:!1,message:"settings must be an object"};if(Object.keys(i).length===0)return{success:!1,message:"settings must not be empty"};if(a==="AccessibilityAnalysis"){const e=[];if(i.distance||e.push('Feld "Entfernung" fehlt'),i.mode!=="region"&&e.push("'Modus Erreichbarkeit der Ausgew\xE4hlten Einrichtungen' muss ausgew\xE4hlt sein"),i.scaleUnit||e.push("'Masseinheit der Entfernung muss ausgew\xE4hlt sein"),i.transportType||e.push("Transportmittel muss ausgew\xE4hlt sein"),(!i.selectedFacilityNames||i.selectedFacilityNames.length===0)&&e.push("'Thema' muss ausgew\xE4hlt sein"),e.length>0)return{success:!1,message:"Erreichbarkeitsanalyse:"+e.join(`.
; `),individualMessages:e}}if(a==="Dashboard"){const e=[];if("statsFeatureFilter"in i||e.push("Statistische Filter fehlt"),"calculations"in i||e.push("Berechnungen fehlen in Einstellungen"),e.length>0)return{success:!1,message:"Dashboard:"+e.join(`.
; `)}}return{success:!0,message:null}}var c=I},3804:function(T,x,o){var s=Object.create,p=Object.defineProperty,w=Object.getOwnPropertyDescriptor,j=Object.getOwnPropertyNames,S=Object.getOwnPropertySymbols,b=Object.getPrototypeOf,_=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable,c=(O,f,d)=>f in O?p(O,f,{enumerable:!0,configurable:!0,writable:!0,value:d}):O[f]=d,a=(O,f)=>{for(var d in f||(f={}))_.call(f,d)&&c(O,d,f[d]);if(S)for(var d of S(f))I.call(f,d)&&c(O,d,f[d]);return O},i=(O,f)=>{for(var d in f)p(O,d,{get:f[d],enumerable:!0})},e=(O,f,d,m)=>{if(f&&typeof f=="object"||typeof f=="function")for(let P of j(f))!_.call(O,P)&&P!==d&&p(O,P,{get:()=>f[P],enumerable:!(m=w(f,P))||m.enumerable});return O},r=(O,f,d)=>(d=O!=null?s(b(O)):{},e(f||!O||!O.__esModule?p(d,"default",{value:O,enumerable:!0}):d,O)),u=O=>e(p({},"__esModule",{value:!0}),O),n={};i(n,{default:()=>h}),T.exports=u(n);var v=o(10),E=r(o(3679)),h=a({},(0,v.generateSimpleGetters)(E.default))},3805:function(T,x,o){var s=Object.create,p=Object.defineProperty,w=Object.defineProperties,j=Object.getOwnPropertyDescriptor,S=Object.getOwnPropertyDescriptors,b=Object.getOwnPropertyNames,_=Object.getOwnPropertySymbols,I=Object.getPrototypeOf,c=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,i=(m,P,A)=>P in m?p(m,P,{enumerable:!0,configurable:!0,writable:!0,value:A}):m[P]=A,e=(m,P)=>{for(var A in P||(P={}))c.call(P,A)&&i(m,A,P[A]);if(_)for(var A of _(P))a.call(P,A)&&i(m,A,P[A]);return m},r=(m,P)=>w(m,S(P)),u=(m,P)=>{for(var A in P)p(m,A,{get:P[A],enumerable:!0})},n=(m,P,A,L)=>{if(P&&typeof P=="object"||typeof P=="function")for(let C of b(P))!c.call(m,C)&&C!==A&&p(m,C,{get:()=>P[C],enumerable:!(L=j(P,C))||L.enumerable});return m},v=(m,P,A)=>(A=m!=null?s(I(m)):{},n(P||!m||!m.__esModule?p(A,"default",{value:m,enumerable:!0}):A,m)),E=m=>n(p({},"__esModule",{value:!0}),m),y={};u(y,{default:()=>d}),T.exports=E(y);var h=o(10),O=v(o(3679)),d=r(e({},(0,h.generateSimpleMutations)(O.default)),{templateItemOutput(m,{output:P,itemID:A}){m.templateItems[A].output=P}})},3869:function(T,x,o){var s=Object.create,p=Object.defineProperty,w=Object.getOwnPropertyDescriptor,j=Object.getOwnPropertyNames,S=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty,_=(n,v)=>{for(var E in v)p(n,E,{get:v[E],enumerable:!0})},I=(n,v,E,y)=>{if(v&&typeof v=="object"||typeof v=="function")for(let h of j(v))!b.call(n,h)&&h!==E&&p(n,h,{get:()=>v[h],enumerable:!(y=w(v,h))||y.enumerable});return n},c=(n,v,E)=>(E=n!=null?s(S(n)):{},I(v||!n||!n.__esModule?p(E,"default",{value:n,enumerable:!0}):E,n)),a=n=>I(p({},"__esModule",{value:!0}),n),i={};_(i,{default:()=>u}),T.exports=a(i);var e=c(o(3739)),u={startEditingToolSettings(n,v){if(!v.toolName)throw new Error("Kein tool zum bearbeiten gew\xE4hlt");n.dispatch("returnToReportTemplatesInterface"),this.commit("Tools/"+v.toolName+"/setReportTemplateMode",v.templateItemsIndex),this.commit("Tools/"+v.toolName+"/setActive",!0),n.state.editingTool={toolName:v.toolName,templateItemsIndex:v.templateItemsIndex},n.state.active=!1},finishEditingToolSettings(n){const v=n.rootGetters["Tools/ToolBridge/currentSettings"],E=v(n.state.editingTool.toolName),y=(0,e.default)(n.state.editingTool.toolName,E);return y.success&&(n.dispatch("returnToReportTemplatesInterface"),n.state.editingTool={toolName:null,templateItemsIndex:null,accepted:!0}),y},abortEditingToolSettings(n){n.dispatch("returnToReportTemplatesInterface"),n.state.editingTool={toolName:null,templateItemsIndex:null,accepted:!1}},returnToReportTemplatesInterface(n){for(const v in n.state.supportedTools)this.commit("Tools/"+n.state.supportedTools[v].value+"/setReportTemplateMode",null),this.commit("Tools/"+n.state.supportedTools[v].value+"/setActive",!1);n.state.active=!0}}},3965:function(T,x){var o=Object.defineProperty,s=Object.getOwnPropertyDescriptor,p=Object.getOwnPropertyNames,w=Object.prototype.hasOwnProperty,j=(c,a)=>{for(var i in a)o(c,i,{get:a[i],enumerable:!0})},S=(c,a,i,e)=>{if(a&&typeof a=="object"||typeof a=="function")for(let r of p(a))!w.call(c,r)&&r!==i&&o(c,r,{get:()=>a[r],enumerable:!(e=s(a,r))||e.enumerable});return c},b=c=>S(o({},"__esModule",{value:!0}),c),_={};j(_,{default:()=>I}),T.exports=b(_);function I(c,a=1500){if(!this.$root.$on)throw new Error("$root not available; use promisedEvent.call(parameters..., this)");return new Promise((i,e)=>{function r(){this.$root.$off(c),i()}this.$root.$on(c,r),a&&setTimeout(()=>{e("waiting for promise timed out after "+a+"ms")},a)})}},3966:function(T,x,o){var s=Object.create,p=Object.defineProperty,w=Object.getOwnPropertyDescriptor,j=Object.getOwnPropertyNames,S=Object.getOwnPropertySymbols,b=Object.getPrototypeOf,_=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable,c=(f,d,m)=>d in f?p(f,d,{enumerable:!0,configurable:!0,writable:!0,value:m}):f[d]=m,a=(f,d)=>{for(var m in d||(d={}))_.call(d,m)&&c(f,m,d[m]);if(S)for(var m of S(d))I.call(d,m)&&c(f,m,d[m]);return f},i=(f,d)=>{for(var m in d)p(f,m,{get:d[m],enumerable:!0})},e=(f,d,m,P)=>{if(d&&typeof d=="object"||typeof d=="function")for(let A of j(d))!_.call(f,A)&&A!==m&&p(f,A,{get:()=>d[A],enumerable:!(P=w(d,A))||P.enumerable});return f},r=(f,d,m)=>(m=f!=null?s(b(f)):{},e(d||!f||!f.__esModule?p(m,"default",{value:f,enumerable:!0}):m,f)),u=f=>e(p({},"__esModule",{value:!0}),f),n={};i(n,{default:()=>O}),T.exports=u(n);var v=r(o(3679)),E=r(o(3804)),y=r(o(3805)),h=r(o(3869)),O={namespaced:!0,state:a({},v.default),mutations:y.default,getters:E.default,actions:h.default}},3967:function(T){T.exports=JSON.parse('{"modules":{"tools":{"cosi":{"reportTemplates":{"title":"Report Template","chooseTemplate":"Template w\xE4hlen"}}}}}')},3968:function(T){T.exports=JSON.parse('{"modules":{"tools":{"cosi":{"reportTemplates":{"title":"Report Template"}}}}}')},4154:function(T,x,o){"use strict";o.r(x);var s=o(4155),p=o.n(s);for(var w in s)["default"].indexOf(w)<0&&function(j){o.d(x,j,function(){return s[j]})}(w);x.default=p.a},4155:function(T,x,o){var s=Object.defineProperty,p=Object.defineProperties,w=Object.getOwnPropertyDescriptor,j=Object.getOwnPropertyDescriptors,S=Object.getOwnPropertyNames,b=Object.getOwnPropertySymbols,_=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable,c=(y,h,O)=>h in y?s(y,h,{enumerable:!0,configurable:!0,writable:!0,value:O}):y[h]=O,a=(y,h)=>{for(var O in h||(h={}))_.call(h,O)&&c(y,O,h[O]);if(b)for(var O of b(h))I.call(h,O)&&c(y,O,h[O]);return y},i=(y,h)=>p(y,j(h)),e=(y,h)=>{for(var O in h)s(y,O,{get:h[O],enumerable:!0})},r=(y,h,O,f)=>{if(h&&typeof h=="object"||typeof h=="function")for(let d of S(h))!_.call(y,d)&&d!==O&&s(y,d,{get:()=>h[d],enumerable:!(f=w(h,d))||f.enumerable});return y},u=y=>r(s({},"__esModule",{value:!0}),y),n={};e(n,{default:()=>E}),T.exports=u(n);var v=o(8),E={name:"ToolInfo",props:{title:{type:String,default:"Werkzeuginformationen (Link \xF6ffnen)"},url:{type:[String,Object],default:null},infoText:{type:String,default:void 0},summary:{type:String,default:null},locale:{type:String,default:"de"}},methods:i(a({},(0,v.mapActions)("Alerting",["addSingleAlert","cleanup"])),{showInfo(){return this.url?window.open(this.getUrl(),"_blank"):(this.infoText&&(this.cleanup(),this.addSingleAlert({category:"Info",content:this.infoText,displayClass:"info"})),null)},getUrl(){if(typeof this.url=="string")return this.url;const y=Object.keys(this.url).find(h=>h.substring(0,h.indexOf("-"))===this.locale.substring(0,h.indexOf("-")));return this.url[y]}})}},4156:function(T,x,o){var s=Object.defineProperty,p=Object.getOwnPropertyDescriptor,w=Object.getOwnPropertyNames,j=Object.prototype.hasOwnProperty,S=(i,e)=>{for(var r in e)s(i,r,{get:e[r],enumerable:!0})},b=(i,e,r,u)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of w(e))!j.call(i,n)&&n!==r&&s(i,n,{get:()=>e[n],enumerable:!(u=p(e,n))||u.enumerable});return i},_=i=>b(s({},"__esModule",{value:!0}),i),I={};S(I,{render:()=>c,staticRenderFns:()=>a}),T.exports=_(I);var c=function(){var e=this,r=e._self._c;return r("div",[r("v-row",{attrs:{dense:"",justify:"end"}},[r("v-col",{attrs:{cols:"17"}},[e.summary?r("p",[e._v(`
                `+e._s(e.summary)+`
            `)]):e._e()]),e._v(" "),r("v-col",{attrs:{cols:"1"}},[e.infoText||e.url?r("v-btn",{staticClass:"info_btn",attrs:{title:e.title,depressed:"",right:"",icon:"","x-small":""},on:{click:e.showInfo}},[r("v-icon",[e._v("mdi-help-circle")])],1):e._e()],1)],1),e._v(" "),r("v-divider")],1)},a=[];c._withStripped=!0},4157:function(T,x,o){},4162:function(T,x,o){"use strict";o.r(x);var s=o(4163),p=o(4154);for(var w in p)["default"].indexOf(w)<0&&function(_){o.d(x,_,function(){return p[_]})}(w);var j=o(4164),S=o(1),b=Object(S.a)(p.default,s.render,s.staticRenderFns,!1,null,"0f052480",null);x.default=b.exports},4163:function(T,x,o){"use strict";var s=o(4156),p=o.n(s);o.o(s,"render")&&o.d(x,"render",function(){return s.render}),o.o(s,"staticRenderFns")&&o.d(x,"staticRenderFns",function(){return s.staticRenderFns})},4164:function(T,x,o){"use strict";var s=o(4157),p=o.n(s)},4407:function(T,x,o){"use strict";o.r(x);var s=o(4408),p=o.n(s);for(var w in s)["default"].indexOf(w)<0&&function(j){o.d(x,j,function(){return s[j]})}(w);x.default=p.a},4408:function(T,x,o){var s=Object.create,p=Object.defineProperty,w=Object.defineProperties,j=Object.getOwnPropertyDescriptor,S=Object.getOwnPropertyDescriptors,b=Object.getOwnPropertyNames,_=Object.getOwnPropertySymbols,I=Object.getPrototypeOf,c=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,i=(t,l,g)=>l in t?p(t,l,{enumerable:!0,configurable:!0,writable:!0,value:g}):t[l]=g,e=(t,l)=>{for(var g in l||(l={}))c.call(l,g)&&i(t,g,l[g]);if(_)for(var g of _(l))a.call(l,g)&&i(t,g,l[g]);return t},r=(t,l)=>w(t,S(l)),u=(t,l)=>{for(var g in l)p(t,g,{get:l[g],enumerable:!0})},n=(t,l,g,D)=>{if(l&&typeof l=="object"||typeof l=="function")for(let M of b(l))!c.call(t,M)&&M!==g&&p(t,M,{get:()=>l[M],enumerable:!(D=j(l,M))||D.enumerable});return t},v=(t,l,g)=>(g=t!=null?s(I(t)):{},n(l||!t||!t.__esModule?p(g,"default",{value:t,enumerable:!0}):g,t)),E=t=>n(p({},"__esModule",{value:!0}),t),y={};u(y,{default:()=>U}),T.exports=E(y);var h=v(o(59)),O=v(o(4162)),f=o(41),d=o(8),m=v(o(3804)),P=v(o(3805)),A=v(o(4409)),L=v(o(3965)),C=v(o(3739)),B=o(3649),U={name:"ReportTemplates",components:{Tool:h.default,ToolInfo:O.default},data(){return{uploadedTemplate:null,supportedExportFormats:["HTML","PDF","Importierbares Template (json)"],selectedExportFormat:"HTML",uiModes:{startingTemplateSelected:!1},exportLoading:!1}},computed:e(e(e(e(e(e({},(0,d.mapGetters)("Language",["currentLocale"])),(0,d.mapGetters)("Tools/ReportTemplates",Object.keys(m.default))),(0,d.mapGetters)("Tools/ToolBridge",["currentSettings"])),(0,d.mapGetters)("Maps",{getMapView:"getView"})),(0,d.mapGetters)("Tools/SelectionManager",["lastSelectionWithCurrentDataLayers"])),(0,d.mapGetters)("Tools/DistrictSelector",["selectedDistrictNames"])),watch:{uploadedTemplate(t){if(!t){this.uiModes.startingTemplateSelected=!1;return}const l=new FileReader,g=(()=>D=>{if(!this.templateItemJsonValid(D)){this.addSingleAlert("Datei ist kein valides Report Template."),this.uploadedTemplate=null;return}this.$store.state.Tools.ReportTemplates.templateItems=D})();l.onload=()=>{let D=null;if(l.result)try{D=JSON.parse(l.result)}catch(M){throw this.uploadedTemplate=null,this.addSingleAlert({content:"Datei nicht lesbar oder kein valides JSON",category:"Fehler",displayClass:"error"}),new Error(M)}g(D)},l.readAsText(t),this.uiModes.startingTemplateSelected=!0},editingTool(t,l){const g=t.toolName===null,D=!g,M=t.accepted;if(D&&this.runTool({toolName:this.templateItems[t.templateItemsIndex].tool,settings:this.templateItems[t.templateItemsIndex].settings,outputCallback:()=>{},updateInterfaceOnly:!0}),g&M){this.updateToolSettings(l.templateItemsIndex);try{this.copyCurrentDataSelection(l.templateItemsIndex)}catch(F){console.warn(F)}this.applyChapter(l.templateItemsIndex)}},active(t){if(!t){const l=(0,B.getModelByAttributes)({id:this.$store.state.Tools.ReportTemplates.id});l&&l.set("isActive",!1)}}},created(){this.$on("close",this.close)},mounted(){},methods:r(e(e(e(e(e(e(e(e({},(0,d.mapActions)("Tools/ReportTemplates",["startEditingToolSettings","finishEditingToolSettings","abortEditingToolSettings","returnToReportTemplatesInterface"])),(0,d.mapActions)("Alerting",["addSingleAlert","cleanup"])),(0,d.mapMutations)("Tools/ReportTemplates",Object.keys(P.default))),(0,d.mapActions)("Tools/ToolBridge",["runTool"])),(0,d.mapActions)("Maps",["zoomToExtent"])),(0,d.mapActions)("Alerting",["addSingleAlert"])),(0,d.mapActions)("Tools/ExportPDF",["reportTemplateToPDF"])),(0,d.mapMutations)("Tools/SelectionManager",["addSelection","setActiveSelection","setAcceptSelection"])),{updateToolSettings(t){const l=this.currentSettings(this.templateItems[t].tool);this.templateItems[t].settings=l,this.templateItems[t].hasSettings=!0,this.clearTemplateItemOutput(t)},runTemplate(t,l=0){if(l>=this.templateItems.length){if(t){t();return}return}this.applyChapter(l,()=>{this.runTemplate(t,l+1)})},applyChapter(t,l){const g=this.templateItems[t],D=(0,C.default)(g.tool,g.settings);if(!D.success){this.exportLoading=!1,this.addSingleAlert({content:"Tool Einstellungen f\xFCr Kapitel "+(t+1)+" sind nicht valide:"+D.message,category:"Fehler",displayClass:"error"});return}let M=Promise.resolve();const F=g.tool!=="Dashboard",R=Object.keys(g.dataSelection).length!==0;F&R&&(M=this.setCurrentDataSelectionLayersOnly(g.dataSelection)),M.catch(N=>{console.warn("error:",N),this.addSingleAlert({content:"Daten Kapitel "+(t+1)+" konnten nicht geladen werden.",category:"Fehler",displayClass:"error"}),console.warn("error:",N)}).finally(()=>(this.clearTemplateItemOutput(t),this.updateToolOutput(t))).catch(N=>{console.warn("error:",N),this.addSingleAlert({content:"Analyse Kapitel "+(t+1)+" konnte eventuell nicht ausgefuehrt werden. Bitte \xFCberpr\xFCfen Sie die Tool Einstellungen.",category:"Fehler",displayClass:"error"})}).finally(()=>{this.exportLoading=!1,l&&l()})},updateToolOutput(t){if(!this.templateItems[t].hasSettings)return this.addSingleAlert({content:"Keine Tool Einstellungen verf\xFCgbar",category:"Fehler",displayClass:"error"}),Promise.reject(new Error("No toolBridge settings available for template item "+t));const l=g=>{const D=t;g.type==="error"&&this.addSingleAlert({content:"Problem mit Tool Einstellungen: "+g.message,category:"Fehler",displayClass:"error"}),this.templateItemOutput({output:g,itemID:D}),this.$root.$emit("reportTemplates-received-output-"+t)};return this.runTool({toolName:this.templateItems[t].tool,settings:this.templateItems[t].settings,outputCallback:l}),L.default.call(this,"reportTemplates-received-output-"+t,15e3)},exportTemplate(){if(this.exportLoading=!0,this.selectedExportFormat==="Importierbares Template (json)"){this.exportTemplateJSON(),this.exportLoading=!1;return}this.runTemplate(()=>{this.selectedExportFormat==="HTML"?this.exportTemplateToHTML():this.selectedExportFormat==="PDF"&&this.reportTemplateToPDF(this.templateItems),this.exportLoading=!1})},exportTemplateJSON(){this.downloadObjectAsJson(this.templateItems,"template")},exportTemplateToHTML(){function t(M){if(typeof M!="string")throw new Error("escapeHTML must be a string");return M.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}const l="<span style='color:orange;'>Weiterverarbeitung in Word: <ul><li>Neues Word Dokument \xF6ffnen</li><li>In Word Querformat einstellen</li><li>Inhalt dieser seite markieren (Strg+A) und in Word kopieren</li><li>Alles markieren und Schriftgr\xF6\xDFe verkleinern</li><li>Zeilenumbr\xFCche in Kopfzeilen von Tabellen einf\xFCgen</li><li>Sollten Tabellen nach wie vor zu breit sein, Anzahl der Spalten bzw. ausgew\xE4hlten Gebiete begrenzen</li><li>Spaltenbreite anpassen</li></ul></span>",g=l+this.templateItems.map(M=>{let F="",R="Quelleninformation fehlt.";return M.output.type==="table"&&(F="<br>"+(0,A.default)(M.output.result)),M.output.type==="image"&&(F="<img src='"+M.output.result+"'>"),M.output.sourceInfo&&(R=Object.values(M.output.sourceInfo).map(N=>Object.values(N).map((J,W)=>Object.keys(N)[W]+": "+J).join("<br>")).join("<br><br><br>")),"<h1>"+t(M.title)+"</h1><br><span>"+t(M.description)+"</span><br><br>"+F+"<br><br><span> <b>Quellen:</b><br><br><small>"+R+"</small></span>"}).join("<br>")+`<style>tr{font-size:8pt;}th{font-size:8pt;}th {
    height: 240px;
    vertical-align: bottom;
    text-align: left;
    line-height: 1;
  }th {
    width: 300px;
    transform-origin: bottom left;
    transform: translateX(75px) rotate(-45deg);
  }</style>`,D=window.open("","Export","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=780,height=200,top="+(screen.height-400)+",left="+(screen.width-840));D.document.body.innerHTML=g,D.focus()},downloadObjectAsJson(t,l){const g="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t)),D=document.createElement("a");D.setAttribute("href",g),D.setAttribute("download",l+".json"),document.body.appendChild(D),D.click(),D.remove()},emptyTemplate(){this.setTemplateItems([]),this.uploadedTemplate=null,this.addEmptyTemplateItem()},addEmptyTemplateItem(){const t=1+Math.max(...this.templateItems.map(l=>l.id));this.templateItems.push({title:"Neues Kapitel...",description:"",tool:null,settings:{},hasSettings:!1,output:{},dataSelection:{},dataSelectionApplied:!1,id:t})},deleteTemplateItem(t){this.templateItems.splice(t,1)},clearTemplateItemDataSelection(t){this.templateItems[t].dataSelection={}},clearTemplateItemSettings(t){this.templateItems[t].settings={},this.templateItems[t].hasSettings=!1},clearTemplateItemOutput(t){this.templateItems[t].output={}},copyCurrentDataSelection(t){this.templateItems[t].dataSelection=this.lastSelectionWithCurrentDataLayers},setCurrentDataSelection(t){return Object.keys(t).length===0?(this.addSingleAlert({content:"Gespeicherte Datenauswahl ist leer",category:"Fehler",displayClass:"error"}),Promise.resolve()):(this.setAcceptSelection(null),this.setAcceptSelection(t),L.default.call(this,"featureListUpdatedBy-setBBoxToGeom-updateSource",15e3))},setCurrentDataSelectionLayersOnly(t){const l=this.lastSelectionWithCurrentDataLayers,g=l;return g.storedLayers=t.storedLayers,this.setCurrentDataSelection(g)},getSelectionAndSettings(t){this.clearTemplateItemDataSelection(t),this.clearTemplateItemSettings(t),this.copyCurrentDataSelection(t),this.updateToolSettings(t)},templateItemJsonValid(t){if(!Array.isArray(t))return console.warn("reportTemplate JSON is not an array"),!1;const l=["title","description","tool","settings","hasSettings","output","dataSelection","dataSelectionApplied","id"];for(const g in t)for(const D in l)if(!(l[D]in t[g]))return console.warn("reportTemplate JSON array item "+g+" does not contain key "+l[D]),!1;return!0},openToolInterface(t,l=!0){this.$store.commit("Tools/"+t+"/setActive",!0),l&&this.setActive(!1)},close(){this.setActive(!1);const t=(0,f.getComponent)(this.id);t&&t.set("isActive",!1)}})}},4409:function(T,x,o){"use strict";T.exports=s({}),T.exports.defaults=s;function s(p){var w=p.classes!==!1,j=p.classPrefix||"";return function b(_,I,c){var a=[],i=typeof _,e;if(c=c||[],!(i!=="object"||_==null||_==null)){if(~c.indexOf(_))return"[Circular]";c.push(_)}if(Array.isArray(_))if(Array.isArray(_[0])&&_.every(Array.isArray))a.push("<table>","<tbody>"),e=[],_.forEach(function(u,n){e.push(n),a.push("<tr>"),u.forEach(function(v){a.push("<td"+S(v)+">",b(v,e,c),"</td>")}),a.push("</tr>")}),a.push("</tbody>","</table>");else if(typeof _[0]=="object"){a.push("<table>","<thead>","<tr>");var r={};_.forEach(function(u){typeof u=="object"&&!Array.isArray(u)&&Object.keys(u).forEach(function(n){r[n]=!0})}),e=Object.keys(r),e.forEach(function(u){a.push("<th"+S(_[0][u])+">",u,"</th>")}),a.push("</tr>","</thead>","<tbody>"),_.forEach(function(u){a.push("<tr>"),a.push(b(u,e,c)),a.push("</tr>")}),a.push("</tbody></table>")}else a.push("<table>","<tbody>"),e=[],_.forEach(function(u,n){e.push(n),a.push("<tr>","<td"+S(u)+">",b(u,e,c),"</td>","</tr>")}),a.push("</tbody>","</table>");else _&&typeof _=="object"&&!Array.isArray(_)&&!(_ instanceof Date)?I?I.forEach(function(u){typeof _[u]=="object"&&!Array.isArray(_[u])?a.push("<td"+S(_[u])+">",b(_[u],!1,c),"</td>"):a.push("<td"+S(_[u])+">",b(_[u],I,c),"</td>")}):(a.push("<table>"),Object.keys(_).forEach(function(u){a.push("<tr>","<th"+S(_[u])+">",u,"</th>","<td"+S(_[u])+">",b(_[u],!1,c),"</td>","</tr>")}),a.push("</table>")):a.push(_);return i!=="object"||_==null||_==null||c.pop(_),a.join("")};function S(b){return w?' class="'+j+(b&&b.constructor&&b.constructor.name?b.constructor.name:typeof b).toLowerCase()+(b===null?" null":"")+'"':""}}},4818:function(T,x,o){var s=Object.defineProperty,p=Object.getOwnPropertyDescriptor,w=Object.getOwnPropertyNames,j=Object.prototype.hasOwnProperty,S=(i,e)=>{for(var r in e)s(i,r,{get:e[r],enumerable:!0})},b=(i,e,r,u)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of w(e))!j.call(i,n)&&n!==r&&s(i,n,{get:()=>e[n],enumerable:!(u=p(e,n))||u.enumerable});return i},_=i=>b(s({},"__esModule",{value:!0}),i),I={};S(I,{render:()=>c,staticRenderFns:()=>a}),T.exports=_(I);var c=function(){var e=this,r=e._self._c;return r("Tool",{attrs:{id:e.id,title:e.$t("additional:modules.tools.cosi.reportTemplates.title"),icon:e.icon,active:e.active,"render-to-window":e.renderToWindow,"resizable-window":e.resizableWindow,"deactivate-gfi":e.deactivateGFI},scopedSlots:e._u([{key:"toolBody",fn:function(){return[r("v-app",{attrs:{id:"reporttemplates"}},[r("ToolInfo",{attrs:{url:e.readmeUrl,locale:e.currentLocale}}),e._v(" "),r("v-container",{staticClass:"main_container"},[r("v-row",{staticClass:"mt-5"},[r("v-col",[r("v-row",[r("v-divider")],1),e._v(" "),r("v-row",[r("h4",[e._v(e._s(e.$t("additional:modules.tools.cosi.reportTemplates.chooseTemplate")))])]),e._v(" "),r("v-row",{}),e._v(" "),r("v-row",{},[r("v-file-input",{attrs:{accept:"application/JSON",label:"Datei w\xE4hlen..","solo-filled":"",dense:""},model:{value:e.uploadedTemplate,callback:function(u){e.uploadedTemplate=u},expression:"uploadedTemplate"}}),e._v(" "),r("v-btn",{attrs:{dense:"",small:"",tile:"",color:"grey lighten-1"},on:{click:function(u){e.emptyTemplate(),e.uiModes.startingTemplateSelected=!0}}},[r("v-icon",[e._v("mdi-plus")])],1)],1)],1)],1),e._v(" "),e.templateItems.length>0?r("v-row",{staticClass:"mb-4"},[r("v-col",[r("v-row",[r("v-divider")],1),e._v(" "),r("v-row",[r("h4",[e._v("Template Bearbeiten")])]),e._v(" "),r("v-row",{staticClass:"ml-5"}),e._v(" "),r("v-row",[r("v-col",{attrs:{cols:"12"}},e._l(e.templateItems,function(u,n){return r("v-card",{key:n,staticClass:"mt-5 mb-8 ml-5",attrs:{color:"grey lighten-3",tile:""}},[r("v-card-title",[e._v("Kapitel "+e._s(n+1))]),e._v(" "),r("v-container",[r("v-row",[r("v-col",{attrs:{cols:"12",align:"right"}},[e._v(`
                                                #`+e._s(n+1)+`
                                                `),r("v-icon",{attrs:{small:""},on:{click:function(v){return e.deleteTemplateItem(n)}}},[e._v(`
                                                    mdi-trash-can
                                                `)])],1)],1),e._v(" "),r("v-row",[r("v-col",{attrs:{cols:"12"}},[r("v-text-field",{attrs:{label:"Titel"},model:{value:u.title,callback:function(v){e.$set(u,"title",v)},expression:"templateItem.title"}})],1)],1),e._v(" "),r("v-row",[r("v-col",{attrs:{cols:"12"}},[r("v-textarea",{attrs:{label:"Beschreibung"},model:{value:u.description,callback:function(v){e.$set(u,"description",v)},expression:"templateItem.description"}})],1)],1),e._v(" "),r("v-row",[r("v-col",{attrs:{cols:"12"}},[r("v-select",{attrs:{label:"Tool w\xE4hlen",items:e.supportedTools,"item-text":"title","item-value":"value"},on:{change:function(v){return e.startEditingToolSettings({toolName:u.tool,templateItemsIndex:n})}},model:{value:u.tool,callback:function(v){e.$set(u,"tool",v)},expression:"templateItem.tool"}})],1),e._v(" "),r("v-col",{attrs:{cols:"12"}},[r("v-btn",{attrs:{dense:""},on:{click:function(v){return e.startEditingToolSettings({toolName:u.tool,templateItemsIndex:n})}}},[r("v-icon",[e._v("mdi-pen")]),e._v(` Tool Einstellungen bearbeiten
                                                `)],1),r("br"),r("br")],1)],1),e._v(" "),!u.hasToolSettings&u.tool?r("v-row",[r("v-card",{staticClass:"m-3 p-3 ml-5",attrs:{color:"orange"}},[r("v-card-text",[e._v("Keine Tool Einstellungen gew\xE4hlt. Bitte klicken Sie auf den Stift, und stellen Sie das Tool ein")])],1)],1):e._e()],1)],1)}),1)],1),e._v(" "),r("v-row",{staticClass:"mb-2"},[r("v-col",{attrs:{cols:"12",align:"right"}},[r("v-icon",{on:{click:e.addEmptyTemplateItem}},[e._v(`
                                    mdi-note-plus
                                `)]),e._v(" "),r("v-row")],1)],1),e._v(" "),r("v-row",[e.templateItems.length>0?r("v-btn",{staticClass:"ml-5",attrs:{color:"grey lighten-1",dense:"",small:"",tile:""},on:{click:e.exportTemplateJSON}},[e._v(`
                                Speichern
                            `)]):e._e()],1)],1)],1):e._e(),e._v(" "),e.templateItems.length>0?r("v-row",{staticClass:"mt-4"},[r("v-col",[r("v-row",[r("v-divider")],1),e._v(" "),r("v-row",[r("h4",[e._v("Auf Gebiet anwenden")])]),e._v(" "),r("v-row",{attrs:{height:"5px"}}),e._v(" "),e.selectedDistrictNames.length===0?r("v-row",[r("v-card",{staticClass:"ml-5",attrs:{color:"orange lighten-1"}},[r("v-card-text",[e._v("Keine Gebiete gew\xE4hlt. \xD6ffnen Sie die Gebietsauswahl, und w\xE4hlen Sie die Gebiete, auf die Sie das Report Template anwenden wollen. Kehren Sie dann zum Report Template tool zur\xFCck, um es auf die gew\xE4hlten Gebiete anzuwenden.")]),e._v(" "),r("v-card-actions",[r("v-btn",{on:{click:function(u){return e.openToolInterface("DistrictSelector")}}},[e._v(`
                                        zur Gebietsauswahl
                                    `)])],1)],1)],1):e._e(),e._v(" "),e.selectedDistrictNames.length>0?r("ul",e._l(e.selectedDistrictNames,function(u,n){return r("li",{key:n},[e._v(`
                                `+e._s(u)+`
                            `)])}),0):e._e(),e._v(" "),e.selectedDistrictNames.length>0?r("v-row",[r("v-select",{attrs:{label:"Export Format",items:e.supportedExportFormats},model:{value:e.selectedExportFormat,callback:function(u){e.selectedExportFormat=u},expression:"selectedExportFormat"}})],1):e._e(),e._v(" "),e.selectedDistrictNames.length>0?r("v-row",{staticClass:"mb-2"},[r("v-btn",{staticClass:"ml-5",attrs:{dense:"",small:"",tile:"",width:"100px",color:"grey lighten-1"},on:{click:e.exportTemplate}},[e.exportLoading?r("div",[r("v-progress-circular",{attrs:{indeterminate:""}})],1):r("div",[e._v(`
                                    Exportieren
                                `)])])],1):e._e()],1)],1):e._e()],1)],1)]},proxy:!0}])})},a=[];c._withStripped=!0},4819:function(T,x,o){},5426:function(T,x,o){"use strict";o.r(x);var s=o(5427),p=o(4407);for(var w in p)["default"].indexOf(w)<0&&function(_){o.d(x,_,function(){return p[_]})}(w);var j=o(5428),S=o(1),b=Object(S.a)(p.default,s.render,s.staticRenderFns,!1,null,"2ca7a2b6",null);x.default=b.exports},5427:function(T,x,o){"use strict";var s=o(4818),p=o.n(s);o.o(s,"render")&&o.d(x,"render",function(){return s.render}),o.o(s,"staticRenderFns")&&o.d(x,"staticRenderFns",function(){return s.staticRenderFns})},5428:function(T,x,o){"use strict";var s=o(4819),p=o.n(s)}}]);
