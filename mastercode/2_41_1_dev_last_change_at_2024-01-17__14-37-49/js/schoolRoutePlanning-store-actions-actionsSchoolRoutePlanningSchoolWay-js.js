(window.webpackJsonp=window.webpackJsonp||[]).push([[490],{4053:function(x,q,c){(function(S){var d=Object.create,v=Object.defineProperty,P=Object.getOwnPropertyDescriptor,R=Object.getOwnPropertyNames,j=Object.getPrototypeOf,D=Object.prototype.hasOwnProperty,m=(e,t)=>{for(var s in t)v(e,s,{get:t[s],enumerable:!0})},w=(e,t,s,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let l of R(t))!D.call(e,l)&&l!==s&&v(e,l,{get:()=>t[l],enumerable:!(r=P(t,l))||r.enumerable});return e},f=(e,t,s)=>(s=e!=null?d(j(e)):{},w(t||!e||!e.__esModule?v(s,"default",{value:e,enumerable:!0}):s,e)),y=e=>w(v({},"__esModule",{value:!0}),e),O={};m(O,{default:()=>a}),x.exports=y(O);var E=f(c(4217)),b=f(c(90)),I=f(c(284)),o=c(140),n=c(58),a={selectSchool({state:e,commit:t,dispatch:s},r){const l=e.houseNumbers.find(u=>u.name.toLowerCase()===e.inputAddress.toLowerCase()),i=r.selectedSchoolId;if(i){const u=e.schools.find(p=>p.get("schul_id")===i);t("setSelectedSchool",u),s("setGeometryByFeatureId",{id:"endPoint",source:r.layer.getSource(),geometry:u?.getGeometry()||[]}),l&&s("prepareWayToSchoolRequest",{selectedHouseNumber:l,selectedSchoolId:i})}},prepareWayToSchoolRequest({state:e,commit:t,dispatch:s},r){var l,i,u,p,g;let h={"Schul-ID":{dataType:"string",value:r.selectedSchoolId},SchuelerStrasse:{dataType:"string",value:e.streetNames[0]},SchuelerHausnr:{dataType:"integer",value:parseInt((i=(l=r.selectedHouseNumber)==null?void 0:l.properties)==null?void 0:i.hausnummer._,10)},SchuelerZusatz:{dataType:"string",value:((g=(p=(u=r.selectedHouseNumber)==null?void 0:u.properties)==null?void 0:p.hausnummernzusatz)==null?void 0:g._)||""},RouteAusgeben:{dataType:"boolean",value:1}};e.wpsTimeout&&Object.keys(e.wpsTimeout).length>0&&(h=Object.assign(h,e.wpsTimeout)),t("setSelectedAddress",e.inputAddress),s("requestWayToSchool",h)},requestWayToSchool({state:e,dispatch:t},s){b.default.show(),E.default.wpsRequest(e.wpsId,e.fmwProcess,s,(r,l)=>t("parseResponseWayToSchool",{response:r,status:l}),5e4)},parseResponseWayToSchool({dispatch:e},t){var s,r,l,i,u,p,g,h,L,T,M,A,W,X,C,N,k,z,G,H,J;b.default.hide();const _=(g=(p=(u=(i=(l=(r=(s=t?.response)==null?void 0:s.ExecuteResponse)==null?void 0:r.ProcessOutputs)==null?void 0:l.Output)==null?void 0:i.Data)==null?void 0:u.ComplexData)==null?void 0:p.Schulweg)==null?void 0:g.Ergebnis;_===void 0?e("Alerting/addSingleAlert",S.t("additional:modules.tools.schoolRoutePlanning.responseError",{errorMessage:((C=(X=(W=(A=(M=(T=(L=(h=t?.response)==null?void 0:h.ExecuteResponse)==null?void 0:L.ProcessOutputs)==null?void 0:T.Output)==null?void 0:M.Data)==null?void 0:A.ComplexData)==null?void 0:W.serviceResponse)==null?void 0:X.statusInfo)==null?void 0:C.message)||((J=(H=(G=(z=(k=(N=t?.response)==null?void 0:N.ExecuteResponse)==null?void 0:k.Status)==null?void 0:z.ProcessFailed)==null?void 0:G.ExceptionReport)==null?void 0:H.Exception)==null?void 0:J.ExceptionText)}),{root:!0}):t.status===200&&_?.ErrorOccured==="no"?e("parseRouteElements",_):e("Alerting/addSingleAlert",S.t("additional:modules.tools.schoolRoutePlanning.wpsError",{status:_.status}),{root:!0})},parseRouteElements({commit:e,dispatch:t},s){const r=s.routenbeschreibung.part,l=s.route.edge;e("setRouteElements",s),e("setRouteDescription",Array.isArray(r)?r:[r]),e("setRouteLength",(0,I.default)(s.kuerzesteStrecke)+"m"),t("parseRoute",Array.isArray(l)?l:[l])},parseRoute({commit:e},t){const s=new n.WKT,r=new o.MultiLineString({});t.forEach(l=>{r.appendLineString(s.readGeometry(l.wkt))}),e("setRouteGeometry",r)}}}).call(this,c(6))},4217:function(x,q,c){var S=Object.create,d=Object.defineProperty,v=Object.getOwnPropertyDescriptor,P=Object.getOwnPropertyNames,R=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty,D=(o,n)=>{for(var a in n)d(o,a,{get:n[a],enumerable:!0})},m=(o,n,a,e)=>{if(n&&typeof n=="object"||typeof n=="function")for(let t of P(n))!j.call(o,t)&&t!==a&&d(o,t,{get:()=>n[t],enumerable:!(e=v(n,t))||e.enumerable});return o},w=(o,n,a)=>(a=o!=null?S(R(o)):{},m(n||!o||!o.__esModule?d(a,"default",{value:o,enumerable:!0}):a,o)),f=o=>m(d({},"__esModule",{value:!0}),o),y={};D(y,{default:()=>I}),x.exports=f(y);var O=w(c(25)),E=w(c(1203)),b=w(c(7)),I={sendRequest:function(o,n,a,e){(0,O.default)({method:"post",url:o,data:n,headers:{"Content-Type":"text/xml"},timeout:e}).then(t=>this.handleResponse(t,a))},handleResponse:function(o,n){let a;o.status===200&&(a=this.parseDataString(o.data)),n(a,o.status)},parseDataString:function(o){const n=new DOMParser().parseFromString(o,"text/xml");return(0,E.default)(n,!1)},buildXML:function(o,n,a,e={}){let t=this.setXMLElement(n,"</ows:Identifier>",o);return Object.entries(e).forEach(s=>{const r=s[1],l=s[0],i=Object.prototype.hasOwnProperty.call(r,"dataType")?r.dataType:void 0,u=Object.prototype.hasOwnProperty.call(r,"value")?r.value:r;let p;p=this.setXMLElement(a,"</ows:Identifier>",l),p=this.setXMLElement(p,"</wps:LiteralData>",u,i),t=this.setXMLElement(t,"</wps:DataInputs>",p)}),t},setXMLElement:function(o,n,a,e){let t=o===void 0?"":o;return e!==void 0&&(t=t.toString().replace("<wps:LiteralData>","<wps:LiteralData dataType='"+e+"'>")),o!==void 0&&n!==void 0&&a!==void 0&&(t=t.toString().replace(n.toString(),a.toString()+n.toString())),t},wpsRequest:function(o,n,a,e,t){var s;const r='<wps:Execute xmlns:wps="http://www.opengis.net/wps/1.0.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ows="http://www.opengis.net/ows/1.1" service="WPS" version="1.0.0" xsi:schemaLocation="http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsExecute_request.xsd"><ows:Identifier></ows:Identifier><wps:DataInputs></wps:DataInputs></wps:Execute>',l="<wps:Input><ows:Identifier></ows:Identifier><wps:Data><wps:LiteralData></wps:LiteralData></wps:Data></wps:Input>",i=this.buildXML(n,r,l,a),u=(s=b.default.getters.getRestServiceById(o))==null?void 0:s.url;this.sendRequest(u,i,e,t)}}}}]);
