(window.webpackJsonp=window.webpackJsonp||[]).push([[488],{4051:function(h,P,c){var i=Object.defineProperty,d=Object.getOwnPropertyDescriptor,g=Object.getOwnPropertyNames,b=Object.prototype.hasOwnProperty,y=(s,e)=>{for(var r in e)i(s,r,{get:e[r],enumerable:!0})},f=(s,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of g(e))!b.call(s,t)&&t!==r&&i(s,t,{get:()=>e[t],enumerable:!(o=d(e,t))||o.enumerable});return s},v=s=>f(i({},"__esModule",{value:!0}),s),m={};y(m,{default:()=>S}),h.exports=v(m);var l=c(453),p=c(140),N=c(2109),S={setGazetteerUrl({state:s,rootGetters:e}){var r;(0,l.setGazetteerUrl)((r=e.getRestServiceById(s.serviceId))==null?void 0:r.url)},processInput({dispatch:s},e){const r=e.evt.target.value,o=e.layer;r.slice(-1)!==" "&&r.length>2&&s("searchStreets",{input:r,layer:o})},searchStreets({rootGetters:s,dispatch:e},{input:r,layer:o}){(0,l.search)(r,{map:mapCollection.getMap(s["Maps/mode"]),searchStreets:!0,searchStreetBeforeWord:!1},!0).then(t=>{const n=t.map(a=>a.name).sort();e("processStreetNames",{input:r,layer:o,sortedStreetNames:n})}).catch(t=>{t.message.trim()!=="The operation was aborted."&&t.message.trim()!=="The user aborted a request."&&console.error("schoolRoutePlanning: An error occurred while searching.",t)})},processStreetNames({commit:s,dispatch:e},{input:r,layer:o,sortedStreetNames:t}){t.length===1?(s("setStreetNames",t),e("searchHousenumbers",{streetName:t[0],eventType:"input"})):t.length>0?(s("setStreetNames",t),s("setHouseNumbers",[]),s("setFilteredHouseNumbers",[])):e("filterHouseNumbers",{input:r,layer:o})},searchHousenumbers({rootGetters:s,commit:e},r){const o=r.streetName;r?.eventType==="click"&&(e("setStreetNames",[o]),e("setInputAddress",o)),(0,l.search)(o,{map:mapCollection.getMap(s.mode),searchStreets:!0,searchHouseNumbers:!0,searchStreetBeforeWord:!1}).then(t=>{const n=t.filter(u=>u.type==="houseNumbersForStreet"),a=(0,N.sortObjectsByNestedAttributes)(n,["properties.hausnummernzusatz._","properties.hausnummer._"]);e("setHouseNumbers",a),e("setFilteredHouseNumbers",a)}).catch(t=>{t.message.trim()!=="The operation was aborted."&&t.message.trim()!=="The user aborted a request."&&console.error("schoolRoutePlanning: An error occurred while searching.",t)})},filterHouseNumbers({state:s,commit:e,dispatch:r},o){const t=o.input,n=s.houseNumbers.filter(a=>a.name.toLowerCase().includes(t.toLowerCase()));e("setInputAddress",t),n.length===1?(r("setGeometryByFeatureId",{id:"startPoint",source:o.layer.getSource(),geometry:new p.Point(n[0].geometry.coordinates.map(a=>parseInt(a,10)))}),r("searchRegionalPrimarySchool",n[0].name)):e("setFilteredHouseNumbers",n)},findHouseNumber({state:s,commit:e,dispatch:r},o){var t;const n=o.input,a=s.houseNumbers.find(u=>u.name===n);e("setInputAddress",n),a&&(r("setGeometryByFeatureId",{id:"startPoint",source:o.layer.getSource(),geometry:new p.Point(a.geometry.coordinates.map(u=>parseInt(u,10)))}),r("searchRegionalPrimarySchool",a.name),r("selectSchool",{selectedSchoolId:(t=s.selectedSchoolNumber)==null?void 0:t.id,layer:o.layer}))},searchRegionalPrimarySchool({commit:s,rootGetters:e},r){(0,l.search)(r,{map:mapCollection.getMap(e["Maps/mode"]),searchAddress:!0}).then(o=>{s("setRegionalPrimarySchool",o[0].properties.grundschulnr+"-0")})}}}}]);
