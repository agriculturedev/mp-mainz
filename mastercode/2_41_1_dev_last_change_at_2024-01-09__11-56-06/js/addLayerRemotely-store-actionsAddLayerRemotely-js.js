(window.webpackJsonp=window.webpackJsonp||[]).push([[115,112,114],{3745:function(A,Z,v){(function(r,T){var I=Object.defineProperty,M=Object.getOwnPropertyDescriptor,E=Object.getOwnPropertyNames,F=Object.prototype.hasOwnProperty,j=(p,d)=>{for(var h in d)I(p,h,{get:d[h],enumerable:!0})},C=(p,d,h,c)=>{if(d&&typeof d=="object"||typeof d=="function")for(let y of E(d))!F.call(p,y)&&y!==h&&I(p,y,{get:()=>d[y],enumerable:!(c=M(d,y))||c.enumerable});return p},V=p=>C(I({},"__esModule",{value:!0}),p),w={};j(w,{getFeatureIds:()=>_,returnGeoJSONLayerObject:()=>D}),A.exports=V(w);function _(p){var d,h;const c=[],y=r.request("Map","getLayers").getArray().find(a=>a.get("id")===p);return typeof y>"u"?(console.warn(T.t("common:modules.featureViaURL.messages.layerNotFound")),c):(y.getSource().getFeatures().forEach(a=>{c.push(a.getId())}),c.length<1&&((h=(d=y.getSource())==null?void 0:d.getSource())!=null&&h.getFeatures().length)&&y.getSource().getSource().getFeatures().forEach(a=>{c.push(a.getId())}),c)}function D(p,d,h,c,y,a="showAll",s=void 0,n="default",m=void 0){const g={type:"layer",name:p,id:d,typ:"GeoJSON",geojson:h,transparent:!0,gfiAttributes:a,layerAttribution:"nicht vorhanden",legendURL:"",isBaseLayer:!1,isSelected:!0,isVisibleInTree:!0,cache:!1,datasets:[],urlIsVisible:!0,gfiTheme:n};return c!==void 0&&(g.styleId=c),y!==void 0&&(g.parentId=y),s!==void 0&&(g.clusterDistance=s),m!==void 0&&(g.mouseHoverField=m),g}}).call(this,v(3),v(6))},3746:function(A,Z,v){(function(r,T){var I=Object.create,M=Object.defineProperty,E=Object.getOwnPropertyDescriptor,F=Object.getOwnPropertyNames,j=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty,V=(e,t)=>{for(var l in t)M(e,l,{get:t[l],enumerable:!0})},w=(e,t,l,P)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of F(t))!C.call(e,i)&&i!==l&&M(e,i,{get:()=>t[i],enumerable:!(P=E(t,i))||P.enumerable});return e},_=(e,t,l)=>(l=e!=null?I(j(e)):{},w(t||!e||!e.__esModule?M(l,"default",{value:e,enumerable:!0}):l,e)),D=e=>w(M({},"__esModule",{value:!0}),e),p={};V(p,{default:()=>s,getIfInExtent:()=>g,getParsedTitle:()=>S,getReversedData:()=>J,isVersionEnabled:()=>m,parseLayer:()=>n}),A.exports=D(p);var d=v(58),h=v(5),c=_(v(45)),y=_(v(25)),a=_(v(7));function s(e,t,l,P){if(e.includes("http:")){console.error("https required");return}r.trigger("Util","showLoader"),(0,y.default)({timeout:4e4,url:`${e}${e.includes("?")?"&":"?"}request=GetCapabilities&service=WMS`}).then(i=>i.data).then(i=>{var u,L;r.trigger("Util","hideLoader");try{const O=new d.WMSCapabilities,o=O.read(i),x=o?.version,b=m(x),U=(L=(u=r.request("Parser","getPortalConfig"))==null?void 0:u.mapView)==null?void 0:L.extent,W=a.default.getters["Maps/projection"].code_;let N=g(o,U,W),B="external_",G=o;if(!b){const f=J(i);G=O.read(f),N=g(G,U,W)}if(!N){console.error("Layer is outside the map extent");return}r.request("Parser","getItemByAttributes",{id:"ExternalLayer"})===void 0&&(r.trigger("Parser","addFolder",l,"ExternalLayer","tree",0),r.trigger("ModelList","renderTree"),T("#Overlayer").parent().after(T("#ExternalLayer").parent())),B=B+S(G.Service.Title),r.trigger("Parser","addFolder",G.Service.Title,B,"ExternalLayer",0),t?t.forEach(f=>{const z={id:S(f.title),name:f.title,parentId:B,level:1,layers:f.name,url:e,version:x,transparent:f.layerTransparent?f.layerTransparent:!0,isSelected:f.layerOn?!0:f.layerOn,time:f.layerTime?f.layerTime:!1,infoFormat:f.infoFormat?f.infoFormat:"text/xml",styles:f.style?f.style:"",cache:!1,datasets:[],featureCount:3,format:"image/png",gfiAttributes:"showAll",gutter:"0",isBaseLayer:!1,layerAttribution:"nicht vorhanden",legendURL:"",maxScale:"2500000",minScale:"0",singleTile:!1,supported:["2D","3D"],tilesize:"512",typ:"WMS",type:"layer",urlIsVisible:!0};r.trigger("Parser","addItem",z),r.trigger("ModelList","addModelsByAttributes",{id:S(f.title)})}):G.Capability.Layer.Layer.forEach(f=>{n(f,B,1,x,e),r.trigger("ModelList","addModelsByAttributes",{id:S(f.Title)})}),P&&r.trigger("Map","zoomToExtent",{extent:N}),r.trigger("ModelList","closeAllExpandedFolder")}catch(O){console.error(O)}},i=>{r.trigger("Util","hideLoader"),console.error(i)})}function n(e,t,l,P,i){Object.prototype.hasOwnProperty.call(e,"Layer")?(e.Layer.forEach(u=>{n(u,S(e.Title),l+1)}),r.trigger("Parser","addFolder",e.Title,S(e.Title),t,l,!1,!1,e.invertLayerOrder)):r.trigger("Parser","addLayer",e.Title,S(e.Title),t,l,e.Name,i,P,{isSelected:!0})}function m(e){if(typeof e!="string")return!1;const t=e.split(".");return parseInt(t[0],10)<1?!1:!(t.length>=2&&parseInt(t[0],10)===1&&parseInt(t[1],10)<3)}function g(e,t,l){var P,i,u;const L=(u=(i=(P=e?.Capability)==null?void 0:P.Layer)==null?void 0:i.BoundingBox)==null?void 0:u.filter(o=>o?.crs&&o?.crs.includes("EPSG")&&c.default.getProjection(o?.crs)!==void 0&&Array.isArray(o?.extent)&&o?.extent.length===4);let O;if(Array.isArray(L)&&L.length){let o=[],x=[];return L.forEach(b=>{b.crs===l&&(o=[b.extent[0],b.extent[1]],x=[b.extent[2],b.extent[3]])}),!o.length&&!x.length&&(o=c.default.transformCoord(L[0].crs,l,[L[0].extent[0],L[0].extent[1]]),x=c.default.transformCoord(L[0].crs,l,[L[0].extent[2],L[0].extent[3]])),O=[o[0],o[1],x[0],x[1]],!Array.isArray(t)||t.length!==4||(0,h.intersects)(t,O)?O:!1}return!0}function J(e){let t=new XMLSerializer().serializeToString(e);return t=t.replace(/<SRS>/g,"<CRS>").replace(/<\/SRS>/g,"</CRS>").replace(/SRS=/g,"CRS="),t=new DOMParser().parseFromString(t,"text/xml"),t}function S(e){return String(e).replace(/\s+/g,"-").replace(/\//g,"-").replace(/:/g,"-").replace(/\(/g,"-").replace(/\)/g,"-")}}).call(this,v(3),v(14))},3859:function(A,Z,v){(function(r,T){var I=Object.create,M=Object.defineProperty,E=Object.getOwnPropertyDescriptor,F=Object.getOwnPropertyNames,j=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty,V=(a,s)=>{for(var n in s)M(a,n,{get:s[n],enumerable:!0})},w=(a,s,n,m)=>{if(s&&typeof s=="object"||typeof s=="function")for(let g of F(s))!C.call(a,g)&&g!==n&&M(a,g,{get:()=>s[g],enumerable:!(m=E(s,g))||m.enumerable});return a},_=(a,s,n)=>(n=a!=null?I(j(a)):{},w(s||!a||!a.__esModule?M(n,"default",{value:a,enumerable:!0}):n,a)),D=a=>w(M({},"__esModule",{value:!0}),a),p={};V(p,{default:()=>y}),A.exports=D(p);var d=v(3745),h=_(v(3746)),c=_(v(78)),y={addGeoJson({rootState:a},{name:s,id:n,geoJSON:m,styleId:g,folderName:J,gfiAttributes:S,zoomTo:e=!0,clusterDistance:t=void 0,gfiTheme:l="default",mouseHoverField:P=void 0}){const i=r.request("Parser","getTreeType"),u=mapCollection.getMap("2D"),L=u?u.getLayers().getArray().find(x=>x.get("id")===n):void 0;let O="",o={};L?(u?.removeLayer(L),r.trigger("ModelList","removeModelsById",n),r.trigger("ModelList","removeLayerById",n),r.trigger("Parser","removeItem",n)):m?.styles&&c.default.addToStyleList(m.styles),i==="custom"||i==="default"?(r.request("Parser","getItemByAttributes",{id:"ExternalLayer"})===void 0&&(r.trigger("Parser","addFolder",J,"ExternalLayer","tree",0),r.trigger("ModelList","renderTree"),T("#Overlayer").parent().after(T("#ExternalLayer").parent())),O="ExternalLayer"):O="tree",o=(0,d.returnGeoJSONLayerObject)(s,n,m,g,O,S,t,l,P),r.trigger("Parser","addItem",o),r.trigger("ModelList","addModelsByAttributes",{id:n}),r.trigger("ModelList","renderTree"),P&&(a.MouseHover.mouseHoverLayers.push(o),a.MouseHover.mouseHoverInfos.push({id:o.id,mouseHoverField:o.mouseHoverField})),i==="light"&&r.trigger("ModelList","refreshLightTree"),e&&r.trigger("Map","zoomToFilteredFeatures",(0,d.getFeatureIds)(n),n),window.addEventListener("touchmove",()=>u.getView().getZoom()<u.getView().getMinZoom()?(u.getView().setZoom(u.getView().getMinZoom()),!1):u.getView().getZoom()>u.getView().getMaxZoom()?(u.getView().setZoom(u.getView().getMaxZoom()),!1):!0)},addWMS(a,{url:s,layersToLoad:n=void 0,folderName:m="Externe Daten",zoomTo:g=!1}){(0,h.default)(s,n,m,g)},toggleLayerVisibility(a,{layerId:s}){const n=r.request("ModelList","getModelByAttributes",{id:s});n&&r.trigger("ModelList","setModelAttributesById",s,{isSelected:!n.get("isSelected")})}}}).call(this,v(3),v(14))}}]);
