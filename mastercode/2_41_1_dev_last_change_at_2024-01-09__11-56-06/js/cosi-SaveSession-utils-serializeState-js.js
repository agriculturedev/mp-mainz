(window.webpackJsonp=window.webpackJsonp||[]).push([[341],{3974:function(M,H,u){var A=Object.create,s=Object.defineProperty,G=Object.defineProperties,N=Object.getOwnPropertyDescriptor,C=Object.getOwnPropertyDescriptors,J=Object.getOwnPropertyNames,O=Object.getOwnPropertySymbols,x=Object.getPrototypeOf,_=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable,v=(e,r,t)=>r in e?s(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,n=(e,r)=>{for(var t in r||(r={}))_.call(r,t)&&v(e,t,r[t]);if(O)for(var t of O(r))E.call(r,t)&&v(e,t,r[t]);return e},w=(e,r)=>G(e,C(r)),V=(e,r)=>{for(var t in r)s(e,t,{get:r[t],enumerable:!0})},b=(e,r,t,a)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of J(r))!_.call(e,o)&&o!==t&&s(e,o,{get:()=>r[o],enumerable:!(a=N(r,o))||a.enumerable});return e},D=(e,r,t)=>(t=e!=null?A(x(e)):{},b(r||!e||!e.__esModule?s(t,"default",{value:e,enumerable:!0}):t,e)),k=e=>b(s({},"__esModule",{value:!0}),e),P={};V(P,{deepCopyState:()=>y,deepSerialize:()=>p,hasDeepFeatures:()=>T,serializeFeatures:()=>f,serializeGeometry:()=>d,serializeNeighborhood:()=>h,serializeScenario:()=>j,serializeScenarioFeature:()=>g,serializeState:()=>B,serializeToolDatasets:()=>F}),M.exports=k(P);var m=u(58),S=D(u(21)),l=u(140),z=D(u(18));function B(e,r,t){const a=y(e,r.state,t);return K(a,r),I(a),L(a),a}function y(e,r,t){const a={};for(const o in e)if(Array.isArray(e[o])&&e[o].every(i=>typeof i=="string")){a[o]={};for(const i of e[o]){const c=T(o,i,t)?F(r[o][i]):f(r[o][i]);a[o][i]=c}}else(0,z.default)(e[o])&&(a[o]=y(e[o],r[o],t));return a}function p(e){let r;if((0,z.default)(e)){r=n({},e);for(const t in r)r[t]=p(r[t]);return r}else if(Array.isArray(e)){r=[...e];for(const t in e)r[t]=p(r[t]);return r}return f(e)}function f(e){const r=new m.GeoJSON;let t;if(!Array.isArray(e))e instanceof S.default?(t=r.writeFeatureObject(e),t.properties.isOlFeature=!0):[l.Point,l.MultiPoint,l.Polygon,l.MultiPolygon].includes(e?.constructor)?(t=r.writeGeometryObject(e),t.isOlGeometry=e.getType()):t=e;else{t=[];for(let a=0;a<e.length;a++)if(e[a]instanceof S.default){const o=r.writeFeatureObject(e[a]);o.properties.isOlFeature=!0,t.push(o)}else t.push(e[a])}return t}function I(e){const r=new m.GeoJSON;e.Tools.ScenarioBuilder.scenarios=e.Tools.ScenarioBuilder.scenarios.map(t=>j(t,r))}function j(e,r){const t=e.getSimulatedFeatures().map(i=>g(i,r)),a=e.getModifiedFeatures().map(i=>g(i,r,!0)),o=e.getNeighborhoods().map(i=>h(i,r));return w(n({},e),{guideLayer:null,isActive:!1,simulatedFeatures:t,modifiedFeatures:a,neighborhoods:o})}function g(e,r,t=!1){var a,o;const i=r.writeFeatureObject(e.feature);i.properties.originalData&&(i.properties.originalData=n({},i.properties.originalData)),(a=i.properties.originalData)!=null&&a.geometry&&(i.properties.originalData.geometry=d(i.properties.originalData.geometry)),e.scenarioData.geometry&&(e.scenarioData.geometry=d(e.scenarioData.geometry)),t&&(i.geometry=((o=i.properties.originalData)==null?void 0:o.geometry)||i.geometry,i.properties=n(n({},i.properties),i.properties.originalData||{})),Object.hasOwnProperty.call(i.properties,"originalData")&&delete i.properties.originalData;for(const c in i.properties)i.properties[c]instanceof l.Geometry&&delete i.properties[c];return w(n({},e),{guideLayer:null,scenario:null,eventKeys:null,feature:i,layer:e.layer.get("id")})}function h(e,r){return!e?.feature||typeof r?.writeFeatureObject!="function"?{}:{feature:r.writeFeatureObject(e.feature)}}function d(e){if(typeof e.getType!="function"||typeof e.getCoordinates!="function")return{};const r=e.getType(),t=e.getCoordinates();return{type:r,coordinates:t}}function L(e){var r;e.Tools.Draw.layer=f(((r=e.Tools.Draw.layer)==null?void 0:r.getSource().getFeatures())||[])}function F(e){return p(e)}function K(e,r){e.Maps.view=r.getters["Maps/getView"]}function T(e,r,t){var a;const o=Object.keys(t).find(i=>e.includes(i));return(a=t[o])==null?void 0:a.includes(r)}}}]);
