(window.webpackJsonp=window.webpackJsonp||[]).push([[435,433,434,436,437],{3687:function(S,V){var d=Object.defineProperty,O=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,T=Object.prototype.hasOwnProperty,P=(u,p)=>{for(var F in p)d(u,F,{get:p[F],enumerable:!0})},w=(u,p,F,E)=>{if(p&&typeof p=="object"||typeof p=="function")for(let y of n(p))!T.call(u,y)&&y!==F&&d(u,y,{get:()=>p[y],enumerable:!(E=O(p,y))||E.enumerable});return u},B=u=>w(d({},"__esModule",{value:!0}),u),h={};P(h,{default:()=>A}),S.exports=B(h);var A={active:!1,deactivateGFI:!1,icon:"bi-file-earmark-arrow-up-fill",id:"fileImportAddon",name:"KML-Datei laden",pointImages:{black:["cc000000","/img/tools/draw/circle_black.svg"],blue:["cc0000FF","/img/tools/draw/circle_blue.svg"],green:["cc00FF00","/img/tools/draw/circle_green.svg"],yellow:["cc00FFFF","/img/tools/draw/circle_yellow.svg"],red:["ccFF0000","/img/tools/draw/circle_red.svg"],white:["ccFFFFFF","/img/tools/draw/circle_white.svg"]},textColors:{schwarz:"cc000000",blau:"ccFF0000",gruen:"cc00FF00",gelb:"cc00FFFF",rot:"cc0000FF",weiss:"ccFFFFFF"},textSizes:{klein:1,mittel:1.15,gross:1.3},onlyDesktop:!0,renderToWindow:!0,resizableWindow:!1,selectedFiletype:"auto",importedFileNames:[],supportedFiletypes:{auto:{caption:"additional:modules.tools.FileImportAddon.captions.supportedFiletypes.auto"},kml:{caption:"additional:modules.tools.FileImportAddon.captions.supportedFiletypes.kml",rgx:/\.kml$/i},gpx:{caption:"additional:modules.tools.FileImportAddon.captions.supportedFiletypes.gpx",rgx:/\.gpx$/i},geojson:{caption:"additional:modules.tools.FileImportAddon.captions.supportedFiletypes.geojson",rgx:/\.(geo)?json$/i}},title:"KML-Datei laden"}},3822:function(S,V,d){var O=Object.create,n=Object.defineProperty,T=Object.getOwnPropertyDescriptor,P=Object.getOwnPropertyNames,w=Object.getOwnPropertySymbols,B=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,u=(a,e,t)=>e in a?n(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,p=(a,e)=>{for(var t in e||(e={}))h.call(e,t)&&u(a,t,e[t]);if(w)for(var t of w(e))A.call(e,t)&&u(a,t,e[t]);return a},F=(a,e)=>{for(var t in e)n(a,t,{get:e[t],enumerable:!0})},E=(a,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of P(e))!h.call(a,o)&&o!==t&&n(a,o,{get:()=>e[o],enumerable:!(r=T(e,o))||r.enumerable});return a},y=(a,e,t)=>(t=a!=null?O(B(a)):{},E(e||!a||!a.__esModule?n(t,"default",{value:a,enumerable:!0}):t,a)),I=a=>E(n({},"__esModule",{value:!0}),a),b={};F(b,{default:()=>D}),S.exports=I(b);var x=d(10),M=y(d(3687)),D=p({},(0,x.generateSimpleGetters)(M.default))},3823:function(S,V,d){var O=Object.create,n=Object.defineProperty,T=Object.getOwnPropertyDescriptor,P=Object.getOwnPropertyNames,w=Object.getOwnPropertySymbols,B=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,u=(a,e,t)=>e in a?n(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t,p=(a,e)=>{for(var t in e||(e={}))h.call(e,t)&&u(a,t,e[t]);if(w)for(var t of w(e))A.call(e,t)&&u(a,t,e[t]);return a},F=(a,e)=>{for(var t in e)n(a,t,{get:e[t],enumerable:!0})},E=(a,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of P(e))!h.call(a,o)&&o!==t&&n(a,o,{get:()=>e[o],enumerable:!(r=T(e,o))||r.enumerable});return a},y=(a,e,t)=>(t=a!=null?O(B(a)):{},E(e||!a||!a.__esModule?n(t,"default",{value:a,enumerable:!0}):t,a)),I=a=>E(n({},"__esModule",{value:!0}),a),b={};F(b,{default:()=>D}),S.exports=I(b);var x=d(10),M=y(d(3687)),D=p({},(0,x.generateSimpleMutations)(M.default))},3870:function(S,V,d){(function(O,n){var T=Object.create,P=Object.defineProperty,w=Object.getOwnPropertyDescriptor,B=Object.getOwnPropertyNames,h=Object.getPrototypeOf,A=Object.prototype.hasOwnProperty,u=(r,o)=>{for(var l in o)P(r,l,{get:o[l],enumerable:!0})},p=(r,o,l,_)=>{if(o&&typeof o=="object"||typeof o=="function")for(let c of B(o))!A.call(r,c)&&c!==l&&P(r,c,{get:()=>o[c],enumerable:!(_=w(o,c))||_.enumerable});return r},F=(r,o,l)=>(l=r!=null?T(h(r)):{},p(o||!r||!r.__esModule?P(l,"default",{value:r,enumerable:!0}):l,r)),E=r=>p(P({},"__esModule",{value:!0}),r),y={};u(y,{default:()=>t}),S.exports=E(y);var I=d(58),b=F(d(121)),x=F(d(822));const M={kml:new I.KML({extractStyles:!0}),gpx:new I.GPX,geojson:new I.GeoJSON};function L(r,o,l,_){if(o!=="auto")return _[o]===void 0?(console.warn('File import tool: Selected filetype "'+o+'" has no OL Format defined for it.'),!1):_[o];for(const c in l)if(l[c].rgx!==void 0&&r.match(l[c].rgx)!==null){if(_[c]===void 0){console.warn('File import tool: Filetype "'+c+`" is defined as supported, but there isn't any OL Format defined for it.`);continue}return _[c]}return!1}function D(r){let o=r;return o=r.replace(/<.*?cascadingstyle.*?kml:id="(.+)">\s*<style>/gmi,(l,_)=>'<Style id="'+_+'">'),o=o.replace(/<\/Style>\s*<\/.*?cascadingstyle>/gmi,"</Style>"),o}function a(r,o,l,_){const c=new DOMParser().parseFromString(r,"text/xml"),G=c.getElementsByTagName("Placemark");return c.getElementsByTagName("kml").length&&c.getElementsByTagName("kml")[0].attributes.xmlns.value.includes("/2.0")&&c.getElementsByTagName("Folder").length&&Array.prototype.forEach.call(G,s=>{const C=c.getElementsByTagName("Style"),f=s.getElementsByTagName("styleUrl")[0].firstChild.nodeValue.replace("#","");let i="";if(Array.prototype.forEach.call(C,m=>{m.attributes.id.value.includes(f)&&(i=m)}),s.getElementsByTagName("Point").length)if(i.getElementsByTagName("IconStyle").length){const m=i.getElementsByTagName("IconStyle")[0];m.getElementsByTagName("color").length&&m.removeChild(m.getElementsByTagName("color")[0]),m.getElementsByTagName("colorMode")&&m.removeChild(m.getElementsByTagName("colorMode")[0]),m.getElementsByTagName("scale")[0].childNodes[0].nodeValue="1",s.getElementsByTagName("name")[0].childNodes[0].nodeValue=""}else if(s.getElementsByTagName("Data").length&&s.getElementsByTagName("Data")[0].attributes.name.value.includes("feature_name")&&s.getElementsByTagName("Data")[1].attributes.name.value.includes("farbe")){const m=s.getElementsByTagName("Data")[1].getElementsByTagName("value")[0].childNodes[0].nodeValue,g=s.getElementsByTagName("Data")[2].getElementsByTagName("value")[0].childNodes[0].nodeValue,v=new DOMParser().parseFromString("<IconStyle><scale>0</scale><Icon><href>"+o.blue[1]+"</href></Icon></IconStyle>","text/xml");Object.entries(l).forEach(([N,j])=>{m===N&&(i.getElementsByTagName("LabelStyle")[0].getElementsByTagName("color")[0].childNodes[0].nodeValue=j)}),Object.entries(_).forEach(([N,j])=>{if(g===N){const J=new DOMParser().parseFromString("<scale>"+j+"</scale>","text/xml");i.getElementsByTagName("LabelStyle")[0].appendChild(J.getElementsByTagName("scale")[0])}}),s.getElementsByTagName("name")[0].childNodes[0].nodeValue=s.getElementsByTagName("Data")[0].getElementsByTagName("value")[0].childNodes[0].nodeValue,i.appendChild(v.getElementsByTagName("IconStyle")[0])}else if(s.getElementsByTagName("Data").length&&s.getElementsByTagName("Data")[1].attributes.name.value.includes("umkreis_gruppe")){const m=new DOMParser().parseFromString("<IconStyle><scale>0</scale><Icon><href>"+o.blue[1]+"</href></Icon></IconStyle>","text/xml");i.appendChild(m.getElementsByTagName("IconStyle")[0]),s.getElementsByTagName("name")[0].childNodes[0].nodeValue=""}else if(s.getElementsByTagName("ExtendedData").length)s.getElementsByTagName("name")[0].childNodes[0].nodeValue="";else{let m;if(i.getElementsByTagName("LineStyle").length&&i.getElementsByTagName("LineStyle")[0].getElementsByTagName("color").length){const v=i.getElementsByTagName("LineStyle")[0].getElementsByTagName("color")[0].childNodes[0].nodeValue;Object.entries(o).forEach(([,N])=>{N[0]===v&&(m=N[1])})}const g=new DOMParser().parseFromString("<IconStyle><scale>1</scale><Icon><href>"+m+"</href></Icon></IconStyle>","text/xml");i.appendChild(g.getElementsByTagName("IconStyle")[0]),s.getElementsByTagName("name")[0].childNodes[0].nodeValue=""}s.appendChild(i)}),Array.prototype.forEach.call(G,s=>{if(s.getElementsByTagName("name").length&&s.getElementsByTagName("name")[0].childNodes.length&&s.getElementsByTagName("href").length&&s.getElementsByTagName("href")[0].childNodes.length){const C=s.getElementsByTagName("name")[0].childNodes[0].nodeValue,f=s.getElementsByTagName("href")[0].childNodes[0].nodeValue;let i="";f.includes("damage_account.jpg")&&(i=f.replace("damage_account.jpg","damage_account_"+C+".jpg"),s.getElementsByTagName("name")[0].childNodes[0].nodeValue="",s.getElementsByTagName("href")[0].childNodes[0].nodeValue=i)}}),c}function e(r,o,l){O.request("Parser","getItemByAttributes",{id:"importedData"})===void 0&&(O.trigger("Parser","addFolder","Importierte Daten","importedData","tree",0),O.trigger("ModelList","renderTree"),document.getElementById("Overlayer").parentNode.appendChild(document.getElementById("importedData").parentNode)),O.trigger("Parser","addVectorLayer",r,o,l,"importedData"),O.trigger("ModelList","closeAllExpandedFolder")}var t={setSelectedFiletype:({commit:r},o)=>{r("setSelectedFiletype",o)},importKML:({state:r,dispatch:o},l)=>{const _=l.checkSameLayer,c=l.layerName,G="imported"+(0,b.default)("_"),s=L(l.filename,r.selectedFiletype,r.supportedFiletypes,M);let C=!1,f,i,m=l.raw;if(Array.isArray(_)&&_.length){f={category:n.t("common:modules.alerting.categories.error"),content:n.t("additional:modules.tools.fileImportAddon.alertingMessages.sameName",{filename:l.filename.split(".")[0]})},o("Alerting/addSingleAlert",f,{root:!0});return}if(s instanceof I.KML&&(m=a(D(l.raw),l.pointImages,l.textColors,l.textSizes)),s===!1){const g=l.filename.split("."),v=g.length>0?"*."+g[g.length-1]:"unknown";f={category:n.t("common:modules.alerting.categories.error"),content:n.t("additional:modules.tools.fileImportAddon.alertingMessages.missingFormat",{format:v})},o("Alerting/addSingleAlert",f,{root:!0});return}try{if(i=s.readFeatures(m),s instanceof I.KML){const g=[];if(i.forEach((v,N)=>{v.getGeometry()!==null&&v.getGeometry().getType()==="Point"&&v.values_.name===void 0&&g.push(N)}),g.length>0){const v=new I.KML({extractStyles:!0,showPointNames:!1}),N=v.readFeatures(m);g.forEach(j=>{i[j]=N[j]})}}}catch(g){console.warn(g),f={category:n.t("common:modules.alerting.categories.error"),content:n.t("additional:modules.tools.fileImportAddon.alertingMessages.formatError",{filename:l.filename})},o("Alerting/addSingleAlert",f,{root:!0});return}if(!Array.isArray(i)||i.length===0){f={category:n.t("common:modules.alerting.categories.error"),content:n.t("additional:modules.tools.fileImportAddon.alertingMessages.missingFileContent",{filename:l.filename})},o("Alerting/addSingleAlert",f,{root:!0});return}i.forEach(g=>{let v;if(g.get("isGeoCircle")){const N=g.get("geoCircleCenter").split(",").map(parseFloat),j=parseFloat(g.get("geoCircleRadius"));g.setGeometry(new x.default(N,j))}g.getGeometry()===null?(C=!0,f={category:n.t("common:modules.alerting.categories.error"),content:n.t("additional:modules.tools.fileImportAddon.alertingMessages.featureError")},o("Alerting/addSingleAlert",f,{root:!0})):(g.getGeometry().getType()==="GeometryCollection"?v=g.getGeometry().getGeometries():v=[g.getGeometry()],v.forEach(N=>{N.transform("EPSG:4326","EPSG:25832")}))}),C?f={category:n.t("common:modules.alerting.categories.info"),content:n.t("additional:modules.tools.fileImportAddon.alertingMessages.successPartly",{filename:l.filename})}:f={category:n.t("common:modules.alerting.categories.info"),content:n.t("additional:modules.tools.fileImportAddon.alertingMessages.success",{filename:l.filename})},o("Alerting/addSingleAlert",f,{root:!0}),o("addImportedFilename",l.filename),e(c,G,i)},addImportedFilename:({state:r,commit:o},l)=>{const _=[...r.importedFileNames];_.push(l),o("setImportedFileNames",_)}}}).call(this,d(3),d(6))},4003:function(S,V,d){var O=Object.create,n=Object.defineProperty,T=Object.getOwnPropertyDescriptor,P=Object.getOwnPropertyNames,w=Object.getOwnPropertySymbols,B=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,u=(e,t,r)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,p=(e,t)=>{for(var r in t||(t={}))h.call(t,r)&&u(e,r,t[r]);if(w)for(var r of w(t))A.call(t,r)&&u(e,r,t[r]);return e},F=(e,t)=>{for(var r in t)n(e,r,{get:t[r],enumerable:!0})},E=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let l of P(t))!h.call(e,l)&&l!==r&&n(e,l,{get:()=>t[l],enumerable:!(o=T(t,l))||o.enumerable});return e},y=(e,t,r)=>(r=e!=null?O(B(e)):{},E(t||!e||!e.__esModule?n(r,"default",{value:e,enumerable:!0}):r,e)),I=e=>E(n({},"__esModule",{value:!0}),e),b={};F(b,{default:()=>a}),S.exports=I(b);var x=y(d(3687)),M=y(d(3870)),L=y(d(3822)),D=y(d(3823)),a={namespaced:!0,state:p({},x.default),mutations:D.default,actions:M.default,getters:L.default}}}]);
