(window.webpackJsonp=window.webpackJsonp||[]).push([[552],{3883:function(_,R,p){(function(f){var V=Object.create,v=Object.defineProperty,C=Object.getOwnPropertyDescriptor,k=Object.getOwnPropertyNames,q=Object.getPrototypeOf,I=Object.prototype.hasOwnProperty,S=(o,n)=>{for(var t in n)v(o,t,{get:n[t],enumerable:!0})},M=(o,n,t,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let e of k(n))!I.call(o,e)&&e!==t&&v(o,e,{get:()=>n[e],enumerable:!(r=C(n,e))||r.enumerable});return o},h=(o,n,t)=>(t=o!=null?V(q(o)):{},M(n||!o||!o.__esModule?v(t,"default",{value:o,enumerable:!0}):t,o)),E=o=>M(v({},"__esModule",{value:!0}),o),P=(o,n,t)=>new Promise((r,e)=>{var a=l=>{try{s(t.next(l))}catch(c){e(c)}},i=l=>{try{s(t.throw(l))}catch(c){e(c)}},s=l=>l.done?r(l.value):Promise.resolve(l.value).then(a,i);s((t=t.apply(o,n)).next())}),O={};S(O,{default:()=>L}),_.exports=E(O);var w=h(p(45)),U=h(p(68)),L={initObliqueView({commit:o,dispatch:n,getters:t,rootGetters:r}){const e=document.getElementById("obliqueIframe");e?.addEventListener("load",()=>{const a=new MutationObserver(()=>{const i=e.contentWindow.document.getElementById("header"),s=e.contentWindow.document.getElementsByClassName("vcm-btn-icon single-first maptool-btn vcm-btn-base-default vcm-btn-base-splash-hover vcm-border vcm-border-dye03 vcm-btn-icon-font-default vcm-btn-icon-font-dye01-hover vcm-no-select vcm-btn-map-Oblique")[0],l=e.contentWindow.document.getElementsByClassName("overview-map-wrap")[0],c=document.getElementById("obliqueIframe").contentWindow.vcs,d=c.vcm.Framework.getInstance().getActiveMap(),m=mapCollection.getMap("2D").getPixelFromCoordinate(r["Maps/initialCenter"]),g=e.contentWindow.document.getElementsByClassName("mapElement vcm-map-top");if(o("Maps/setClickCartesianCoordinate",m,{root:!0}),d&&(d.olMap.on("moveend",()=>{const u=w.default.transform("EPSG:4326",mapCollection.getMapView("2D").getProjection().getCode(),d.getViewPointSync().groundPosition);u.every((y,b)=>Math.round(y)!==Math.round(t.lastCoordinates[b])&&(y-t.lastCoordinates[b]>50||y-t.lastCoordinates[b]<-50)?(n("setObliqueView",u),!1):!0)}),d.imageChanged.addEventListener(()=>P(this,null,function*(){const u=yield d.getViewPoint();u.heading!==t.heading&&n("MapMarker/rotatePointMarker",u.heading,{root:!0}),o("setHeading",u.heading)}))),i){i.style.display="none",i.parentElement.style.display="none";for(const u of g)u.style.top=0;o("setDefaultMapMarkerStyleId",r["MapMarker/pointStyleId"]),t.styleId&&o("MapMarker/setPointStyleId",t.styleId,{root:!0}),n("setObliqueView",r["Maps/center"]),a.disconnect()}s&&(s.style.display="none"),l&&(l.style.display="none")});a.observe(e.contentDocument,{childList:!0,subtree:!0})})},resetObliqueViewer({commit:o,dispatch:n,getters:t}){o("MapMarker/setPointStyleId",t.defaultMapMarkerStyleId,{root:!0}),n("MapMarker/removePointMarker",null,{root:!0})},setObliqueView(o){return P(this,arguments,function*({commit:n,dispatch:t,getters:r},e=[]){var a,i,s,l,c;const d=(i=(a=document.getElementById("obliqueIframe"))==null?void 0:a.contentWindow)==null?void 0:i.vcs,m=(l=(s=d?.vcm)==null?void 0:s.Framework)==null?void 0:l.getInstance(),g=m?.getActiveMap();let u={};m&&e&&Array.isArray(e)&&e.length>1?(n("setLastCoordinates",e),(c=d?.vcm)!=null&&c.util&&(u=new d.vcm.util.ViewPoint({groundPosition:w.default.transform(mapCollection.getMapView("2D").getProjection().getCode(),"EPSG:4326",e),heading:r.heading,distance:g.getViewPointSync().distance})),yield m?.getActiveMap().gotoViewPoint(u),t("MapMarker/placingPointMarker",e,{root:!0}),t("MapMarker/rotatePointMarker",r.heading,{root:!0})):t("Alerting/addSingleAlert","<strong>"+f.t("additional:modules.tools.vcOblique.frameworkUndefined")+"</strong><br><small>"+f.t("additional:modules.tools.vcOblique.frameworkUndefinedMessage")+"</small>",{root:!0})})},setObliqueViewerURL({commit:o,dispatch:n,getters:t,rootGetters:r},e){if(e&&Array.isArray(e)&&e.length>1){const a=w.default.transform(mapCollection.getMapView("2D").getProjection().getCode(),"EPSG:4326",e),i=a[0]+", "+a[1];document.location.hostname==="localhost"?o("setObliqueViewerURL",(0,U.default)(r.getRestServiceById(t.serviceId).url)+"?groundPosition="+i):n("setObliqueViewerURLWithSameHostname",i)}},setObliqueViewerURLWithSameHostname({commit:o,dispatch:n,getters:t,rootGetters:r},e){const a=r.getRestServiceById(t.serviceId).url,i=new URL(a),s=new URL(document.location.href);i.hostname===s.hostname?o("setObliqueViewerURL",a+"?groundPosition="+e):document.location.hostname.startsWith("www.")&&document.location.hostname.split("www.")[1]===i.hostname?n("setObliqueViewerURLWithReplacedHostname",{urlParts:i.pathname,startCoordinates:e}):n("Alerting/addSingleAlert",f.t("additional:modules.tools.vcOblique.sameOrigin"),{root:!0})},setObliqueViewerURLWithReplacedHostname({commit:o},{urlParts:n,startCoordinates:t}){let r="https:/";n.forEach((e,a)=>{a===0?r=r+"/"+document.location.hostname:r=r+"/"+e}),o("setObliqueViewerURL",r+"?groundPosition="+t)}}}).call(this,p(6))}}]);
