(window.webpackJsonp=window.webpackJsonp||[]).push([[344,413],{3651:function(D,L,f){var P=Object.create,g=Object.defineProperty,x=Object.getOwnPropertyDescriptor,N=Object.getOwnPropertyNames,E=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty,S=(s,n)=>{for(var l in n)g(s,l,{get:n[l],enumerable:!0})},m=(s,n,l,_)=>{if(n&&typeof n=="object"||typeof n=="function")for(let c of N(n))!C.call(s,c)&&c!==l&&g(s,c,{get:()=>n[c],enumerable:!(_=x(n,c))||_.enumerable});return s},j=(s,n,l)=>(l=s!=null?P(E(s)):{},m(n||!s||!s.__esModule?g(l,"default",{value:s,enumerable:!0}):l,s)),M=s=>m(g({},"__esModule",{value:!0}),s),p={};S(p,{default:()=>J,getAllContainingDistricts:()=>o,getContainingDistrictForExtent:()=>w,getContainingDistrictForFeature:()=>h,intersect:()=>G,union:()=>y}),D.exports=M(p);var u=j(f(4171)),d=j(f(4169)),v=f(58),i=f(5);function o(s,n,l=!1){var _;const c=[];for(const r of s)for(const t of r.districts){const e=(_=t.adminFeature)==null?void 0:_.getGeometry(),a=n.getGeometry().getExtent();if((!e||e.intersectsExtent(a))&&(c.push({districtLevel:r.label,district:t}),!l))break}return l?c:c[0]}function h(s,n,l=!0,_=!1){const c=[];for(const r of s.districts){const t=r.adminFeature.getGeometry(),e=n.getGeometry().getExtent(),a=(0,i.getCenter)(e);if(_)t.intersectsExtent(e)&&c.push(l?r:r.getName());else if(t.intersectsCoordinate(a)){c.push(l?r:r.getName());break}}return _?c:c[0]}function w(s,n,l=!0,_=!1){const c=[];for(const r of s.districts)if(r.adminFeature.getGeometry().intersectsExtent(n)&&(c.push(l?r:r.getName()),!_))break;return _?c:c[0]}function y(s,n=!1,l=!1,_="EPSG:25832",c="EPSG:4326"){const r=new v.GeoJSON({dataProjection:c,featureProjection:_}),t=r.writeFeaturesObject(s);let e=t.features[0];for(let a=1;a<t.features.length;a++)e=(0,u.default)(e,t.features[a]);return n&&(e.properties={}),l&&(e=r.readFeature(e)),e}function G(s,n=!1,l=!1,_="EPSG:25832",c="EPSG:4326"){const r=new v.GeoJSON({dataProjection:c,featureProjection:_}),t=r.writeFeaturesObject(s);let e=t.features[0];for(let a=1;a<t.features.length;a++)e=(0,d.default)(e,t.features[a]);return e&&(n&&(e.properties={}),l&&(e=r.readFeature(e))),e}var J={intersect:G,union:y,getContainingDistrictForFeature:h}},3656:function(D,L,f){var P=Object.defineProperty,g=Object.getOwnPropertyDescriptor,x=Object.getOwnPropertyNames,N=Object.prototype.hasOwnProperty,E=(p,u)=>{for(var d in u)P(p,d,{get:u[d],enumerable:!0})},C=(p,u,d,v)=>{if(u&&typeof u=="object"||typeof u=="function")for(let i of x(u))!N.call(p,i)&&i!==d&&P(p,i,{get:()=>u[i],enumerable:!(v=g(u,i))||v.enumerable});return p},S=p=>C(P({},"__esModule",{value:!0}),p),m={};E(m,{default:()=>j,getLastAvailableYear:()=>M}),D.exports=S(m);function j(p,u="jahr_"){const d=[];return p.forEach(v=>{const i=v.getProperties?v.getProperties():v;Object.keys(i).forEach(o=>{o.includes(u)&&d.push(o.replace(u,""))})}),[...new Set(d)].sort().reverse()}function M(p,u="jahr_"){const d=p.map(v=>Object.keys(v.getProperties()).map(i=>parseInt(i.replace(u,""),10)).filter(i=>!isNaN(i)).sort((i,o)=>o-i));for(let v=0;v<d.length;v++)for(let i=0;i<d[v].length;i++){const o=d[v][i];if(d.every(h=>h.includes(o)))return o}return j(p,u)[0]}},3722:function(D,L,f){var P=Object.create,g=Object.defineProperty,x=Object.defineProperties,N=Object.getOwnPropertyDescriptor,E=Object.getOwnPropertyDescriptors,C=Object.getOwnPropertyNames,S=Object.getOwnPropertySymbols,m=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable,p=(r,t,e)=>t in r?g(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,u=(r,t)=>{for(var e in t||(t={}))j.call(t,e)&&p(r,e,t[e]);if(S)for(var e of S(t))M.call(t,e)&&p(r,e,t[e]);return r},d=(r,t)=>x(r,E(t)),v=(r,t)=>{for(var e in t)g(r,e,{get:t[e],enumerable:!0})},i=(r,t,e,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let O of C(t))!j.call(r,O)&&O!==e&&g(r,O,{get:()=>t[O],enumerable:!(a=N(t,O))||a.enumerable});return r},o=(r,t,e)=>(e=r!=null?P(m(r)):{},i(t||!r||!r.__esModule?g(e,"default",{value:r,enumerable:!0}):e,r)),h=r=>i(g({},"__esModule",{value:!0}),r),w=(r,t,e)=>new Promise((a,O)=>{var I=b=>{try{F(e.next(b))}catch(Y){O(Y)}},A=b=>{try{F(e.throw(b))}catch(Y){O(Y)}},F=b=>b.done?a(b.value):Promise.resolve(b.value).then(I,A);F((e=e.apply(r,t)).next())}),y={};v(y,{default:()=>c}),D.exports=h(y);var G=o(f(3656)),J=o(f(3734)),s=f(3651),n=o(f(7)),l=o(f(4262)),_=o(f(121));class c{constructor(t,e,a){this.feature=t,this.layer=e,this.active=!1,this.activeDistrictLevels=a,this.scenario=null,this.setDefaultProperties(),this.computeContainingDistricts(a)}setDefaultProperties(){this.feature.set("isNeighborhood",!0),this.feature.set("styleId",(0,_.default)()),this.feature.setId((0,l.default)(d(u({},this.feature.getProperties()),{geom:this.feature.getGeometry()})))}renderFeature(){this.active||(this.modifyDistrictStats(),this.layer.getSource().addFeature(this.feature),this.active=!0)}hideFeature(){this.active&&(this.active=!1,this.resetDistrictStats(),this.layer.getSource().removeFeature(this.feature))}computeContainingDistricts(t){const e=(0,s.getAllContainingDistricts)(t,this.feature,!0);this.districts=e.map(a=>u({coverage:a.district.adminFeature?(0,J.default)(this.feature,a.district.adminFeature):1},a))}modifyDistrictStats(){return w(this,null,function*(){for(const t of this.districts){if(yield n.default.dispatch("Tools/DistrictSelector/getStatsByDistrict",{id:t.district.getId(),districtLevel:this.activeDistrictLevels.find(e=>e.label===t.districtLevel)}),t.district.statFeatures.length===0){console.warn(`No statistics have been loaded for ${t.district.getName()}. Cannot apply neighborhood stats.`);continue}this.updateStats(t)}n.default.dispatch("Tools/DistrictSelector/updateDistricts")})}updateStats(t){const e=(0,G.default)(t.district.statFeatures),a=new Date(this.feature.get("year")).getFullYear();let O,I;for(const A of this.feature.get("stats")||[])if(A.valueType==="absolute"){const F=t.district.statFeatures.find(b=>b.get("kategorie")===A.category);if(!F)continue;for(O of e.filter(b=>b>=a))I=parseFloat(F.get("jahr_"+O)),I&&F.set("jahr_"+O,I+Math.round(A.value*t.coverage));F.set("isModified",a)}else A.relation}resetDistrictStats(){const t=new Set(this.scenario.neighborhoods.map(e=>e.districts).flat());for(const e of t)e.district.statFeatures=e.district.originalStatFeatures.map(a=>a.clone());for(const e of this.scenario.neighborhoods)e.active&&e.modifyDistrictStats();n.default.dispatch("Tools/DistrictSelector/updateDistricts")}setFeature(t){this.hideFeature(),this.feature=t,this.setDefaultProperties(),this.renderFeature()}}},3734:function(D,L,f){var P=Object.create,g=Object.defineProperty,x=Object.getOwnPropertyDescriptor,N=Object.getOwnPropertyNames,E=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty,S=(i,o)=>{for(var h in o)g(i,h,{get:o[h],enumerable:!0})},m=(i,o,h,w)=>{if(o&&typeof o=="object"||typeof o=="function")for(let y of N(o))!C.call(i,y)&&y!==h&&g(i,y,{get:()=>o[y],enumerable:!(w=x(o,y))||w.enumerable});return i},j=(i,o,h)=>(h=i!=null?P(E(i)):{},m(o||!i||!i.__esModule?g(h,"default",{value:i,enumerable:!0}):h,i)),M=i=>m(g({},"__esModule",{value:!0}),i),p={};S(p,{default:()=>v}),D.exports=M(p);var u=f(3651),d=j(f(7));function v(i,o){const h=d.default.getters["Maps/projectionCode"],w=(0,u.intersect)([i,o],!0,!0,h),y=i.getGeometry().getArea(),G=w?.getGeometry().getArea()||0;return Math.round((G/y+Number.EPSILON)*1e3)/1e3}},4286:function(D,L){function f(P){var g=new Error("Cannot find module '"+P+"'");throw g.code="MODULE_NOT_FOUND",g}f.keys=function(){return[]},f.resolve=f,D.exports=f,f.id=4286}}]);
