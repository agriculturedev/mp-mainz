(window.webpackJsonp=window.webpackJsonp||[]).push([[522,527],{3765:function(v,O){var g=Object.defineProperty,d=Object.getOwnPropertyDescriptor,w=Object.getOwnPropertyNames,A=Object.prototype.hasOwnProperty,f=(l,n)=>{for(var u in n)g(l,u,{get:n[u],enumerable:!0})},M=(l,n,u,c)=>{if(n&&typeof n=="object"||typeof n=="function")for(let S of w(n))!A.call(l,S)&&S!==u&&g(l,S,{get:()=>n[S],enumerable:!(c=d(n,S))||c.enumerable});return l},_=l=>M(g({},"__esModule",{value:!0}),l),y={};f(y,{default:()=>P}),v.exports=_(y);function P(l){return new Promise((n,u)=>{const c=document.createElement("script");c.type="text/javascript",c.onload=n,c.onerror=u,c.src=l,document.head.append(c)})}},3881:function(v,O,g){(function(d,w){var A=Object.create,f=Object.defineProperty,M=Object.getOwnPropertyDescriptor,_=Object.getOwnPropertyNames,y=Object.getPrototypeOf,P=Object.prototype.hasOwnProperty,l=(e,t)=>{for(var r in t)f(e,r,{get:t[r],enumerable:!0})},n=(e,t,r,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of _(t))!P.call(e,o)&&o!==r&&f(e,o,{get:()=>t[o],enumerable:!(a=M(t,o))||a.enumerable});return e},u=(e,t,r)=>(r=e!=null?A(y(e)):{},n(t||!e||!e.__esModule?f(r,"default",{value:e,enumerable:!0}):r,e)),c=e=>n(f({},"__esModule",{value:!0}),e),S=(e,t,r)=>new Promise((a,o)=>{var p=s=>{try{i(r.next(s))}catch(k){o(k)}},m=s=>{try{i(r.throw(s))}catch(k){o(k)}},i=s=>s.done?a(s.value):Promise.resolve(s.value).then(p,m);i((r=r.apply(e,t)).next())}),V={};l(V,{default:()=>E}),v.exports=c(V);var I=u(g(3765)),E={loadPackages({state:e},t){const r=`https://streetsmart.cyclomedia.com/api/v${e.streetsmartAPIVersion}/StreetSmartApi.js`,a=`https://unpkg.com/react@${e.reactVersion}/umd/react.production.min.js`,o=`https://unpkg.com/react-dom@${e.reactVersion}/umd/react-dom.production.min.js`;try{(0,I.default)(a).then(()=>(0,I.default)(o)).then(()=>(0,I.default)(r)).then(()=>t?t():null).catch(p=>console.error("loading of package failed:",p))}catch(p){console.error("loading of package failed:",p)}},setPosition({state:e,commit:t,dispatch:r,rootGetters:a},o){if(e.active&&o){const p=a["Maps/getView"].getProjection().getCode(),m=!o[0]||!o[1]?o.coordinate:[o[0],o[1]];try{r("MapMarker/placingPointMarker",m,{root:!0}),StreetSmartApi.open({coordinate:m},{viewerType:[StreetSmartApi.ViewerType.PANORAMA],srs:p,panoramaViewer:{replace:!0,timeTravelVisible:e.timeTravelVisible,closable:!1,recordingsVisible:!0}}).then(i=>{if(i&&i[0]){t("setLastCoordinates",m);const s=StreetSmartApi.getViewers();s[0].toggle3DCursor(e.toggle3DCursor),s[0].toggleAddressesVisible(e.toggleAddressesVisible)}else r("Alerting/addSingleAlert",d.t("additional:modules.tools.streetsmart.noData"),{root:!0}),r("MapMarker/placingPointMarker",e.lastCoordinates,{root:!0})}).catch(i=>{console.warn("Error opening panorama viewer: "+i),r("Alerting/addSingleAlert",d.t("additional:modules.tools.streetsmart.createViewFailed"),{root:!0})})}catch(i){console.error("Create streetSmart view failed: ",i),r("Alerting/addSingleAlert",d.t("additional:modules.tools.streetsmart.createViewFailed"),{root:!0})}}},initApi({state:e,dispatch:t,getters:r,rootGetters:a}){const o=a.getRestServiceById(e.serviceId),p=a["Maps/getView"].getProjection().getCode(),m=r.currentLocale;if(o){const i={targetElement:document.getElementById("streetsmart"),username:o.params.username,password:o.params.password,apiKey:o.params.apiKey,srs:o.params.srs?o.params.srs:p,locale:m||o.params.locale};typeof StreetSmartApi>"u"?(console.warn("Cannot start Streetsmart-View. StreetSmartApi is not available."),t("Alerting/addSingleAlert",d.t("additional:modules.tools.streetsmart.createViewFailedMoreInfo"),{root:!0})):StreetSmartApi.init(i).then(function(){t("onInitSuccess"),e.cycloLayerID&&w.trigger("ModelList","showModelInTree",e.cycloLayerID)}).catch(function(s){console.warn("Failed to create component(s) through API: "+s),t("Alerting/addSingleAlert",d.t("additional:modules.tools.streetsmart.createViewFailedMoreInfo"),{root:!0})})}else console.warn("Cannot start Streetsmart-View. No service in rest-services found for serviceId ",e.serviceId),t("Alerting/addSingleAlert",d.t("additional:modules.tools.streetsmart.createViewFailedMoreInfo"),{root:!0})},destroyApi({state:e,dispatch:t,commit:r}){t("MapMarker/removePointMarker",null,{root:!0}),r("MapMarker/setPointStyleId",e.mapMarkerStyleId,{root:!0}),t("removeListener"),StreetSmartApi.destroy({targetElement:document.getElementById("streetsmart")}),e.cycloLayerID&&w.trigger("ModelList","setModelAttributesById",e.cycloLayerID,{isSelected:!1})},moveAndRotateMarker(e,t){return S(this,arguments,function*({dispatch:r,getters:a},o){yield r("MapMarker/placingPointMarker",o.detail.recording.xyz,{root:!0}),r("MapMarker/rotatePointMarker",o.detail.recording.relativeYaw+a.lastYaw,{root:!0}),w.trigger("MapView","setCenter",[o.detail.recording.xyz[0],o.detail.recording.xyz[1]])})},rotateMarker({commit:e,dispatch:t},r){const a=StreetSmartApi.getViewers(),o=a[0].getRecording();t("MapMarker/placingPointMarker",o.xyz,{root:!0}),e("setLastCoordinates",o.xyz),t("MapMarker/rotatePointMarker",r.detail.yaw,{root:!0}),e("setLastYaw",r.detail.yaw)},addListener({dispatch:e}){StreetSmartApi.on(StreetSmartApi.Events.viewer.VIEWER_ADDED,t=>{t.detail.viewer.on(StreetSmartApi.Events.panoramaViewer.RECORDING_CLICK,function(r){e("moveAndRotateMarker",r)}),t.detail.viewer.on(StreetSmartApi.Events.panoramaViewer.VIEW_CHANGE,function(r){e("rotateMarker",r)}),t.detail.viewer.on(StreetSmartApi.Events.panoramaViewer.TILE_LOAD_ERROR,function(r){console.warn(r)})})},removeListener({dispatch:e}){typeof StreetSmartApi<"u"&&typeof StreetSmartApi.on=="function"&&StreetSmartApi.on(StreetSmartApi.Events.viewer.VIEWER_ADDED,t=>{t.detail.viewer.off(StreetSmartApi.Events.panoramaViewer.RECORDING_CLICK,function(r){e("moveAndRotateMarker",r)}),t.detail.viewer.off(StreetSmartApi.Events.panoramaViewer.VIEW_CHANGE,function(r){e("rotateMarker",r)}),t.detail.viewer.off(StreetSmartApi.Events.panoramaViewer.TILE_LOAD_ERROR,function(r){console.warn(r)})})},onInitSuccess({state:e,dispatch:t,commit:r,rootGetters:a,rootState:o}){t("addListener"),r("setMapMarkerStyleId",o.MapMarker.pointStyleId),r("MapMarker/setPointStyleId",e.styleId,{root:!0}),t("setPosition",a["Maps/getView"].getCenter())}}}).call(this,g(6),g(3))}}]);
